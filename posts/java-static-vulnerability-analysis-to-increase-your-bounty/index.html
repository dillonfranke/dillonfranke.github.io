<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Java Static Vulnerability Analysis to Increase Your Bounty | Dillon Franke Security</title>
<meta name=keywords content><meta name=description content="If you want to get serious about finding impactful vulnerabilities through static analysis, it‚Äôs time to move beyond simply grep-ing through code bases. In this blog post, I‚Äôll share my personal process for setting up a robust environment for Java static analysis of console applications, web applications, and Android applications. Once you‚Äôve established this test environment, you‚Äôll be able to take advantage of automatic code references, trace usages across a code base, and leverage source-to-sink analysis to find elusive vulnerabilities. üòà"><meta name=author content><link rel=canonical href=https://www.dillonfrankesecurity.com/posts/java-static-vulnerability-analysis-to-increase-your-bounty/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://www.dillonfrankesecurity.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.dillonfrankesecurity.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.dillonfrankesecurity.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.dillonfrankesecurity.com/apple-touch-icon.png><link rel=mask-icon href=https://www.dillonfrankesecurity.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://www.dillonfrankesecurity.com/posts/java-static-vulnerability-analysis-to-increase-your-bounty/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://www.dillonfrankesecurity.com/posts/java-static-vulnerability-analysis-to-increase-your-bounty/"><meta property="og:site_name" content="Dillon Franke Security"><meta property="og:title" content="Java Static Vulnerability Analysis to Increase Your Bounty"><meta property="og:description" content="If you want to get serious about finding impactful vulnerabilities through static analysis, it‚Äôs time to move beyond simply grep-ing through code bases. In this blog post, I‚Äôll share my personal process for setting up a robust environment for Java static analysis of console applications, web applications, and Android applications. Once you‚Äôve established this test environment, you‚Äôll be able to take advantage of automatic code references, trace usages across a code base, and leverage source-to-sink analysis to find elusive vulnerabilities. üòà"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-03T11:40:07-08:00"><meta property="article:modified_time" content="2023-03-03T11:40:07-08:00"><meta property="og:image" content="https://www.dillonfrankesecurity.com/coffee-cup-space.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.dillonfrankesecurity.com/coffee-cup-space.jpg"><meta name=twitter:title content="Java Static Vulnerability Analysis to Increase Your Bounty"><meta name=twitter:description content="If you want to get serious about finding impactful vulnerabilities through static analysis, it‚Äôs time to move beyond simply grep-ing through code bases. In this blog post, I‚Äôll share my personal process for setting up a robust environment for Java static analysis of console applications, web applications, and Android applications. Once you‚Äôve established this test environment, you‚Äôll be able to take advantage of automatic code references, trace usages across a code base, and leverage source-to-sink analysis to find elusive vulnerabilities. üòà"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://www.dillonfrankesecurity.com/posts/"},{"@type":"ListItem","position":2,"name":"Java Static Vulnerability Analysis to Increase Your Bounty","item":"https://www.dillonfrankesecurity.com/posts/java-static-vulnerability-analysis-to-increase-your-bounty/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Java Static Vulnerability Analysis to Increase Your Bounty","name":"Java Static Vulnerability Analysis to Increase Your Bounty","description":"If you want to get serious about finding impactful vulnerabilities through static analysis, it‚Äôs time to move beyond simply grep-ing through code bases. In this blog post, I‚Äôll share my personal process for setting up a robust environment for Java static analysis of console applications, web applications, and Android applications. Once you‚Äôve established this test environment, you‚Äôll be able to take advantage of automatic code references, trace usages across a code base, and leverage source-to-sink analysis to find elusive vulnerabilities. üòà\n","keywords":[],"articleBody":"If you want to get serious about finding impactful vulnerabilities through static analysis, it‚Äôs time to move beyond simply grep-ing through code bases. In this blog post, I‚Äôll share my personal process for setting up a robust environment for Java static analysis of console applications, web applications, and Android applications. Once you‚Äôve established this test environment, you‚Äôll be able to take advantage of automatic code references, trace usages across a code base, and leverage source-to-sink analysis to find elusive vulnerabilities. üòà\n1. Choose an Integrated Development Environment (‚ÄùIDE‚Äù) To make our static analysis much more effective, it‚Äôs imperative to leverage a Java IDE. An IDE is essentially a fancy text editor with the superpower of being able to resolve code references to external references such as third party libraries or the Java SDK. In this post, I‚Äôll use the excellent IntelliJ IDEA IDE from JetBrains, although you can use any other Java IDE as well such as Eclipse.\n2. Obtain a Java Package (.jar, .war, or .apk) to Analyze When reverse-engineering a Java application, you will typically obtain a package of Java classes in the form of a .jar, .war, or .apk file. Let‚Äôs take a look at the differences between these file types with this table:\nPackage Type Description Example .jar (‚ÄùJava Archive‚Äù) Packaged Java application or library https://repo1.maven.org/maven2/com/squareup/okio/okio/3.3.0/okio-3.3.0.jar .war (‚ÄùWeb Archive‚Äù) Packaged Java web application http://www.opencms.org/en/download/ .apk (‚ÄùAndroid Package‚Äù) Packaged Android application https://play.google.com/store/apps/details?id=no.mobitroll.kahoot.android\u0026gl=US 3. Unpack the Java Package and Obtain .jar Files The next step is to obtain .jar files from our original Java package. This process will vary slightly depending on the type of package you are analyzing.\nGetting .jar Files From a.jar File If you are analyzing a .jar file, you are ready to decompile! That was easy, move on to the next section üôÇ\nGetting .jar Files From a .war File A .war file is really just a .zip archive, so we can unpack it using the unzip or jar utility:\n‚ùØ jar xvf opencms.war created: META-INF/ inflated: META-INF/MANIFEST.MF created: WEB-INF/ inflated: WEB-INF/cmsshell.sh created: WEB-INF/setupdata/ created: WEB-INF/setupdata/database/ created: WEB-INF/setupdata/database/db2/ inflated: WEB-INF/setupdata/database/db2/create_db.sql inflated: WEB-INF/setupdata/database/db2/drop_db.sql inflated: WEB-INF/setupdata/database/db2/drop_tables.sql inflated: WEB-INF/setupdata/database/db2/create_tables.sql created: WEB-INF/setupdata/database/oracle/ inflated: WEB-INF/setupdata/database/oracle/create_db.sql inflated: WEB-INF/setupdata/database/oracle/drop_db.sql inflated: WEB-INF/setupdata/database/oracle/drop_tables.sql inflated: WEB-INF/setupdata/database/oracle/create_tables.sql # Truncated for brevity... A quick find command will show us where all the .jar files are hanging out:\n‚ùØ find . -name \"*.jar\" ./WEB-INF/lib/avatica-core-1.17.0.jar ./WEB-INF/lib/jetty-util-9.4.31.v20200723.jar ./WEB-INF/lib/opencms-setup.jar ./WEB-INF/lib/xercesImpl-2.12.0.jar ./WEB-INF/lib/solr-solrj-8.11.1.jar ./WEB-INF/lib/saaj-impl-1.3.28.jar ./WEB-INF/lib/cssparser-0.9.25.jar ./WEB-INF/lib/org.opencms.locale.it.jar ./WEB-INF/lib/htmlparser-2.1.jar ./WEB-INF/lib/commons-logging-1.2.jar ./WEB-INF/lib/org.opencms.locale.de.jar ./WEB-INF/lib/openpdf-1.3.20.jar ./WEB-INF/lib/poi-ooxml-schemas-4.1.2.jar ./WEB-INF/lib/gwt-elemental-2.9.0.jar ./WEB-INF/lib/alkacon.mercury.xtensions.jar ./WEB-INF/lib/commons-pool2-2.8.1.jar ./WEB-INF/lib/hppc-0.8.2.jar ./WEB-INF/lib/gson-2.8.6.jar # Truncated for brevity... But a lot of these .jar files look like third party libraries that we might not want to spend time decompiling, at least not initially. We want to find the main logic implemented by the developers of the application we‚Äôre looking at to make the best use of our time.\nTo do this, I always check out the web.xml file, which should be in the WEB-INF/ directory. This file is used by Java application servers to determine which classes to route traffic to. For example, the figure below shows a few interesting classes implementing servlets for the OpenCMS application. From what I‚Äôm seeing here, the org.opencms package is looking like a great place to start analyzing.\nThe error handling servlet, also serves as trigger for static export requests. OpenCmsServletErrorHandler org.opencms.main.OpenCmsServletErrorHandler 0 The main servlet that handles all requests to the OpenCms VFS. OpenCmsServlet org.opencms.main.OpenCmsServlet 1 Now, we can use a simple grep to identify .jar files that implement the classes we care about. These matched .jar files seem like great candidates for handling the application‚Äôs main logic\n‚ùØ grep -ir org.opencms WEB-INF/lib Binary file WEB-INF/lib/opencms-setup.jar matches Binary file WEB-INF/lib/org.opencms.locale.it.jar matches Binary file WEB-INF/lib/org.opencms.locale.de.jar matches Binary file WEB-INF/lib/org.opencms.locale.da.jar matches Binary file WEB-INF/lib/org.opencms.locale.es.jar matches Binary file WEB-INF/lib/org.opencms.locale.cs.jar matches Binary file WEB-INF/lib/org.opencms.locale.zh.jar matches Binary file WEB-INF/lib/opencms.jar matches Binary file WEB-INF/lib/opencms-resources.jar matches Binary file WEB-INF/lib/org.opencms.locale.ru.jar matches Binary file WEB-INF/lib/org.opencms.locale.ja.jar matches Binary file WEB-INF/lib/opencms-modules.jar matches Next, let‚Äôs move those .jar files to a separate directory, since we‚Äôll focus on decompiling them first.\n‚ùØ mkdir jars-we-care-about \u0026\u0026 grep -ir org.opencms WEB-INF/lib | awk '{print $3}' | xargs -I{} cp {} jars-we-care-about And we‚Äôve extracted the .jar files from our .war file! Let‚Äôs see how to do it with an .apk file, and then we‚Äôre ready to decompile.\nGetting .jar Files From an .apk File Getting JARs from an .apk file is a bit different because Android applications utilize the Dalvik Executable (‚ÄùDEX‚Äù) format to package Java classes and resources instead of JAR. However, the classes are compiled into the same (mostly, Dalvik bytecode is more optimized) bytecode. So, we can transform a .dex to a .jar file quite easily.\nWe can use unzip or jar once again to unpack the application and identify the .dex files within an .apk file. The figure below shows us identifying two .dex files for the Kahoot android application.\n‚ùØ jar xvf no.mobitroll.kahoot.android.apk inflated: classes.dex # Dex file inflated: classes2.dex # Dex file inflated: lib/arm64-v8a/libpruneau.so inflated: lib/armeabi-v7a/libpruneau.so inflated: lib/x86/libpruneau.so inflated: lib/x86_64/libpruneau.so extracted: assets/audio/TheEnd.mp3 extracted: assets/audio/alt02-answer_010sec.mp3 extracted: assets/audio/alt02-answer_020sec.mp3 extracted: assets/audio/alt02-answer_030sec.mp3 extracted: assets/audio/alt03-answer_010sec.mp3 extracted: assets/audio/alt03-answer_020sec.mp3 extracted: assets/audio/alt03-answer_030sec.mp3 extracted: assets/audio/alt03-answer_060sec.mp3 extracted: assets/audio/alt03-answer_090sec.mp3 extracted: assets/audio/alt03-answer_120sec.mp3 extracted: assets/audio/answer_10sec.mp3 extracted: assets/audio/answer_20sec.mp3 extracted: assets/audio/answer_30sec.mp3 extracted: assets/audio/content_slide_underscore.mp3 extracted: assets/audio/correct_01.mp3 Next, we can use the dex2jar utility to convert the .dex files to .jar files:\n‚ùØ d2j-dex2jar classes* dex2jar classes.dex -\u003e ./classes-dex2jar.jar dex2jar classes2.dex -\u003e ./classes2-dex2jar.jar 4. Decompile the .jar Files With our desired .jar files in hand, it‚Äôs time to decompile them! IntelliJ comes with a great decompiler that you can call from the command line. Here‚Äôs how to do it on Mac:\n‚ùØ mkdir decompiled-jars-we-care-about # Make a new dir for decompiled jars ‚ùØ java -Xmx7066M -cp /Applications/IntelliJ\\ IDEA\\ CE.app/Contents/plugins/java-decompiler/lib/java-decompiler.jar org.jetbrains.java.decompiler.main.decompiler.ConsoleDecompiler -mpm=3 jars-we-care-about decompiled-jars-we-care-about INFO: Decompiling class org/opencms/module/CmsModuleDependency INFO: ... done INFO: Decompiling class org/opencms/module/CmsModuleImportExportRepository INFO: ... done INFO: Decompiling class org/opencms/module/CmsModuleUpdater INFO: ... done INFO: Decompiling class org/opencms/module/CmsResourceImportData INFO: ... done INFO: Decompiling class org/opencms/module/CmsModuleVersion INFO: ... done INFO: Decompiling class org/opencms/module/CmsReplaceModuleInfo INFO: ... done INFO: Decompiling class org/opencms/module/CmsModuleXmlHandler INFO: ... done INFO: Decompiling class org/opencms/module/CmsModuleManager INFO: ... done INFO: Decompiling class org/opencms/module/CmsModule INFO: ... done INFO: Decompiling class org/opencms/module/Messages INFO: ... done INFO: Decompiling class org/opencms/module/CmsModuleImportData # Truncated for brevity... Now, we can unpack the decompiled .jar files to reveal the decompiled Java source code inside!\n‚ùØ cd decompiled-jars-we-care-about ‚ùØ find . -name \"*.jar\" | xargs -I{} jar xvf {} # Unpack all the decompiled JARs inflated: META-INF/MANIFEST.MF created: META-INF/ created: org/ created: org/opencms/ created: org/opencms/setup/ created: org/opencms/setup/ui/ created: org/opencms/setup/db/ created: org/opencms/setup/db/update6to7/ created: org/opencms/setup/db/update6to7/oracle/ created: org/opencms/setup/db/update6to7/postgresql/ created: org/opencms/setup/db/update6to7/mysql/ created: org/opencms/setup/db/update7to8/ created: org/opencms/setup/db/update7to8/oracle/ created: org/opencms/setup/db/update7to8/postgresql/ created: org/opencms/setup/db/update7to8/mysql/ created: org/opencms/setup/updater/ created: org/opencms/setup/updater/dialogs/ created: org/opencms/setup/xml/ created: org/opencms/setup/comptest/ inflated: org/opencms/setup/ui/CmsSetupStep02ComponentCheck.html inflated: org/opencms/setup/ui/CmsSetupErrorDialog.html inflated: org/opencms/setup/ui/CmsSetupStep03Database.html inflated: org/opencms/setup/ui/CmsSetupStep01License.html inflated: org/opencms/setup/ui/CmsSetupStep06ImportReport.html inflated: org/opencms/setup/ui/CmsSetupStep07ConfigNotes.html inflated: org/opencms/setup/ui/CmsSetupStep05ServerSettings.html inflated: org/opencms/setup/ui/CmsSetupStep04Modules.html inflated: org/opencms/setup/ui/CmsDbSettingsPanel.html # Truncated for brevity... We‚Äôre left with .java source files!\n‚ùØ find . -name \"*.java\" ./org/opencms/cmis/CmsCmisTypeManager.java ./org/opencms/cmis/I_CmsCmisObjectHelper.java ./org/opencms/cmis/CmsCmisService.java ./org/opencms/cmis/A_CmsCmisRepository.java ./org/opencms/cmis/I_CmsCmisRenditionProvider.java ./org/opencms/cmis/CmsCmisCallContext.java ./org/opencms/cmis/I_CmsCmisRepository.java ./org/opencms/cmis/CmsCmisRelationHelper.java ./org/opencms/cmis/CmsObjectListLimiter.java ./org/opencms/cmis/CmsCmisResourceHelper.java ./org/opencms/cmis/CmsCmisServiceFactory.java ./org/opencms/cmis/CmsCmisRenditionFilter.java ./org/opencms/cmis/I_CmsPropertyProvider.java ./org/opencms/cmis/CmsCmisUtil.java ./org/opencms/cmis/CmsCmisRepository.java ./org/opencms/ui/I_CmsHasButtons.java ./org/opencms/ui/I_CmsEditPropertyContext.java ./org/opencms/ui/I_CmsUpdateListener.java ./org/opencms/ui/CmsVaadinErrorHandler.java ./org/opencms/ui/CmsUserIconHelper.java ./org/opencms/ui/util/CmsComboNullToEmptyConverter.java ./org/opencms/ui/util/CmsStyleVariable.java ./org/opencms/ui/util/CmsLogicalCheckboxGroup.java ./org/opencms/ui/util/CmsDisplayType.java ./org/opencms/ui/util/CmsNewResourceBuilder.java # Truncated for brevity... 5. Set Up Your IDE Now that we have (basically) Java source code, it‚Äôs time to load it into our IDE and start finding vulnerabilities.\nOpen Your Decompiled Java Code First, fire up IntelliJ and click Open.\nNow, select the directory of decompiled and expanded .jar files we created.\nResolve Dependencies This is where the true magic happens. We‚Äôre going to point IntelliJ to the original .jar files we extracted, (not the decompiled ones) and it is going to allow us to resolve the application‚Äôs dependencies to perform in-depth static analysis.\nGo to File ‚Üí Project Structure‚Ä¶ and, firstly, select a Java SDK that makes sense for the project you‚Äôre analyzing. Be sure to click Apply.\nNext, go the Libraries tab and click - to remove any current dependencies, as these are decompiled .jars and won‚Äôt resolve things properly.\nClick + to add a new project library and choose Java:\nSelect the folder containing the original, compiled .jar files. Include the third party dependencies, we want to be able to resolve them too!\nHit Apply and then OK.\nAdditional Unresolved Dependencies It‚Äôs possible that after adding all the original .jars as libraries, you‚Äôll still have some unresolved dependencies within your project. These will show up red within IntelliJ.\nThis is likely because the application you are analyzing assumes that the system running it will have these dependencies on its class path already. For example, an Android APK should expect the Android SDK to be present, and a web application should expect the javax.servlet package to be present.\nSometimes, you can resolve these dependencies quickly by clicking on the red lightbulb within IntelliJ and then Find JAR on web.\nOtherwise, you can navigate back to File ‚Üí Project Structure‚Ä¶ and add a new library from Maven (the Java package manager).\nSearch for and select the dependency you need to resolve. IntelliJ will download the .jar from Maven and add it to your project.\n6. Profit! I know it took a bit to get here, but by investing time up front, you are now prepared to find vulnerabilities that simply wouldn‚Äôt be possible otherwise.\nFinding Usages One of the pain points of manual static analysis is the tedious process of tracing user-controllable input through the application. Well, with our current setup, we have made our lives much easier. We can click on any variable, method, or class and find all of its assignments and usages throughout the application. For example, we might want to understand how the class variable m_settings is being used throughout the application:\nIntelliJ‚Äôs ability to map out all read and write occurrences of a variable in question greatly speeds up manual static analysis.\nData Flow Analysis IntelliJ goes behind just finding usages, though. It can fully map out the flow of data within the application. To do this, we right click on a variable and go to Analyze ‚Üí Data Flow to Here‚Ä¶ or Data Flow from Here‚Ä¶ Below, we are doing this to understand how the req variable of the doGet() method of an HTTP servlet is being used.\nWe can then easily view all the places the req variable is passed into other functions within the rest of the application in one single place. This is extremely useful during static analysis.\nSink-to-Source Analysis With these tools under our belt, we have to ability to find truly impactful vulnerabilities. We can leverage source-to-sink analysis, (also called taint analysis) where we trace the flow of data from dangerous functions back to parameters we control. For a more in-depth definition of source-to-sink analysis, check out one of my previous blog posts: https://www.mandiant.com/resources/blog/route-sixty-sink-launch.\nFor example, let‚Äôs say we want to look for unsafe deserialization vulnerabilities (they just so happen to be one of my favorite vulnerability classes). We know that a call to java.io.ObjectInputStream::ReadObject() on attacker-controlled data can result in SSRF, file access, or even remote code execution. Let‚Äôs see how to search for Java object deserialization within our application:\nFirst, enter ‚åò + O and search for the java.io.ObjectInputStream class:\nIdentify the readObject() method and view its data flow throughout the application:\nWe immediately have a detailed call graph leading to our sink. If we can trace it to input that we control as an attacker, (an HTTP parameter, header, etc.) we‚Äôve found a vulnerability!\nThanks for reading! Keep an eye out for more security content coming your way soon! Stay safe out there! üîíüíªüë®‚Äçüíª\n","wordCount":"1902","inLanguage":"en","image":"https://www.dillonfrankesecurity.com/coffee-cup-space.jpg","datePublished":"2023-03-03T11:40:07-08:00","dateModified":"2023-03-03T11:40:07-08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.dillonfrankesecurity.com/posts/java-static-vulnerability-analysis-to-increase-your-bounty/"},"publisher":{"@type":"Organization","name":"Dillon Franke Security","logo":{"@type":"ImageObject","url":"https://www.dillonfrankesecurity.com/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.dillonfrankesecurity.com/ accesskey=h title="Dillon Franke Security (Alt + H)">Dillon Franke Security</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.dillonfrankesecurity.com/ title=Home><span>Home</span></a></li><li><a href=https://www.dillonfrankesecurity.com/posts/ title=Blog><span>Blog</span></a></li><li><a href=https://www.dillonfrankesecurity.com/presentations/ title=Presentations><span>Presentations</span></a></li><li><a href=https://www.dillonfrankesecurity.com/services/ title=Services><span>Services</span></a></li><li><a href=https://www.dillonfrankesecurity.com/contact/ title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Java Static Vulnerability Analysis to Increase Your Bounty</h1><div class=post-meta><span title='2023-03-03 11:40:07 -0800 -0800'>March 3, 2023</span>&nbsp;¬∑&nbsp;9 min</div></header><figure class=entry-cover><img loading=eager src=https://www.dillonfrankesecurity.com/coffee-cup-space.jpg alt></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#1-choose-an-integrated-development-environment-ide aria-label="1. Choose an Integrated Development Environment (‚ÄùIDE‚Äù)">1. Choose an Integrated Development Environment (‚ÄùIDE‚Äù)</a></li><li><a href=#2-obtain-a-java-package-jar-war-or-apk-to-analyze aria-label="2. Obtain a Java Package (.jar, .war, or .apk) to Analyze">2. Obtain a Java Package (.jar, .war, or .apk) to Analyze</a></li><li><a href=#3-unpack-the-java-package-and-obtain-jar-files aria-label="3. Unpack the Java Package and Obtain .jar Files">3. Unpack the Java Package and Obtain .jar Files</a><ul><li><a href=#getting-jar-files-from-ajar-file aria-label="Getting .jar Files From a.jar File">Getting .jar Files From a.jar File</a></li><li><a href=#getting-jar-files-from-a--war-file aria-label="Getting .jar Files From a .war File">Getting .jar Files From a .war File</a></li><li><a href=#getting-jar-files-from-an-apk-file aria-label="Getting .jar Files From an .apk File">Getting .jar Files From an .apk File</a></li></ul></li><li><a href=#4-decompile-the-jar-files aria-label="4. Decompile the .jar Files">4. Decompile the .jar Files</a></li><li><a href=#5-set-up-your-ide aria-label="5. Set Up Your IDE">5. Set Up Your IDE</a><ul><li><a href=#open-your-decompiled-java-code aria-label="Open Your Decompiled Java Code">Open Your Decompiled Java Code</a></li><li><a href=#resolve-dependencies aria-label="Resolve Dependencies">Resolve Dependencies</a></li><li><a href=#additional-unresolved-dependencies aria-label="Additional Unresolved Dependencies">Additional Unresolved Dependencies</a></li></ul></li><li><a href=#6-profit aria-label="6. Profit!">6. Profit!</a><ul><li><a href=#finding-usages aria-label="Finding Usages">Finding Usages</a></li><li><a href=#data-flow-analysis aria-label="Data Flow Analysis">Data Flow Analysis</a></li><li><a href=#sink-to-source-analysis aria-label="Sink-to-Source Analysis">Sink-to-Source Analysis</a></li></ul></li></ul></div></details></div><div class=post-content><p>If you want to get serious about finding impactful vulnerabilities through static analysis, it‚Äôs time to move beyond simply <code>grep</code>-ing through code bases. In this blog post, I‚Äôll share my personal process for setting up a robust environment for Java static analysis of console applications, web applications, and Android applications. Once you‚Äôve established this test environment, you‚Äôll be able to take advantage of automatic code references, trace usages across a code base, and leverage source-to-sink analysis to find elusive vulnerabilities. üòà</p><h2 id=1-choose-an-integrated-development-environment-ide>1. Choose an Integrated Development Environment (‚ÄùIDE‚Äù)<a hidden class=anchor aria-hidden=true href=#1-choose-an-integrated-development-environment-ide>#</a></h2><p>To make our static analysis <em><strong><strong><strong><strong><strong><strong><strong>much</strong></strong></strong></strong></strong></strong></strong></em> more effective, it‚Äôs imperative to leverage a Java IDE. An IDE is essentially a fancy text editor with the superpower of being able to resolve code references to external references such as third party libraries or the Java SDK. In this post, I‚Äôll use the excellent <a href=https://www.jetbrains.com/idea/>IntelliJ IDEA IDE</a> from JetBrains, although you can use any other Java IDE as well such as Eclipse.</p><h2 id=2-obtain-a-java-package-jar-war-or-apk-to-analyze>2. Obtain a Java Package (<code>.jar</code>, <code>.war</code>, or <code>.apk</code>) to Analyze<a hidden class=anchor aria-hidden=true href=#2-obtain-a-java-package-jar-war-or-apk-to-analyze>#</a></h2><p>When reverse-engineering a Java application, you will typically obtain a package of Java classes in the form of a <code>.jar</code>, <code>.war</code>, or <code>.apk</code> file. Let‚Äôs take a look at the differences between these file types with this table:</p><table><thead><tr><th>Package Type</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td><code>.jar</code> (‚ÄùJava Archive‚Äù)</td><td>Packaged Java application or library</td><td><a href=https://repo1.maven.org/maven2/com/squareup/okio/okio/3.3.0/okio-3.3.0.jar>https://repo1.maven.org/maven2/com/squareup/okio/okio/3.3.0/okio-3.3.0.jar</a></td></tr><tr><td><code>.war</code> (‚ÄùWeb Archive‚Äù)</td><td>Packaged Java web application</td><td><a href=http://www.opencms.org/en/download/>http://www.opencms.org/en/download/</a></td></tr><tr><td><code>.apk</code> (‚ÄùAndroid Package‚Äù)</td><td>Packaged Android application</td><td><a href="https://play.google.com/store/apps/details?id=no.mobitroll.kahoot.android&amp;gl=US">https://play.google.com/store/apps/details?id=no.mobitroll.kahoot.android&amp;gl=US</a></td></tr></tbody></table><h2 id=3-unpack-the-java-package-and-obtain-jar-files>3. Unpack the Java Package and Obtain <code>.jar</code> Files<a hidden class=anchor aria-hidden=true href=#3-unpack-the-java-package-and-obtain-jar-files>#</a></h2><p>The next step is to obtain <code>.jar</code> files from our original Java package. This process will vary slightly depending on the type of package you are analyzing.</p><h3 id=getting-jar-files-from-ajar-file>Getting <code>.jar</code> Files From a<code>.jar</code> File<a hidden class=anchor aria-hidden=true href=#getting-jar-files-from-ajar-file>#</a></h3><p>If you are analyzing a <code>.jar</code> file, you are ready to decompile! That was easy, move on to the next section üôÇ</p><h3 id=getting-jar-files-from-a--war-file>Getting <code>.jar</code> Files From a <code>.war</code> File<a hidden class=anchor aria-hidden=true href=#getting-jar-files-from-a--war-file>#</a></h3><p>A <code>.war</code> file is really just a <code>.zip</code> archive, so we can unpack it using the <code>unzip</code> or <code>jar</code> utility:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ jar xvf opencms.war
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>created: META-INF/
</span></span><span style=display:flex><span>inflated: META-INF/MANIFEST.MF
</span></span><span style=display:flex><span>created: WEB-INF/
</span></span><span style=display:flex><span>inflated: WEB-INF/cmsshell.sh
</span></span><span style=display:flex><span>created: WEB-INF/setupdata/
</span></span><span style=display:flex><span>created: WEB-INF/setupdata/database/
</span></span><span style=display:flex><span>created: WEB-INF/setupdata/database/db2/
</span></span><span style=display:flex><span>inflated: WEB-INF/setupdata/database/db2/create_db.sql
</span></span><span style=display:flex><span>inflated: WEB-INF/setupdata/database/db2/drop_db.sql
</span></span><span style=display:flex><span>inflated: WEB-INF/setupdata/database/db2/drop_tables.sql
</span></span><span style=display:flex><span>inflated: WEB-INF/setupdata/database/db2/create_tables.sql
</span></span><span style=display:flex><span>created: WEB-INF/setupdata/database/oracle/
</span></span><span style=display:flex><span>inflated: WEB-INF/setupdata/database/oracle/create_db.sql
</span></span><span style=display:flex><span>inflated: WEB-INF/setupdata/database/oracle/drop_db.sql
</span></span><span style=display:flex><span>inflated: WEB-INF/setupdata/database/oracle/drop_tables.sql
</span></span><span style=display:flex><span>inflated: WEB-INF/setupdata/database/oracle/create_tables.sql
</span></span><span style=display:flex><span><span style=color:#75715e># Truncated for brevity...</span>
</span></span></code></pre></div><p>A quick <code>find</code> command will show us where all the <code>.jar</code> files are hanging out:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ find . -name <span style=color:#e6db74>&#34;*.jar&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>./WEB-INF/lib/avatica-core-1.17.0.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/jetty-util-9.4.31.v20200723.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/opencms-setup.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/xercesImpl-2.12.0.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/solr-solrj-8.11.1.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/saaj-impl-1.3.28.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/cssparser-0.9.25.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/org.opencms.locale.it.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/htmlparser-2.1.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/commons-logging-1.2.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/org.opencms.locale.de.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/openpdf-1.3.20.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/poi-ooxml-schemas-4.1.2.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/gwt-elemental-2.9.0.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/alkacon.mercury.xtensions.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/commons-pool2-2.8.1.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/hppc-0.8.2.jar
</span></span><span style=display:flex><span>./WEB-INF/lib/gson-2.8.6.jar
</span></span><span style=display:flex><span><span style=color:#75715e># Truncated for brevity...</span>
</span></span></code></pre></div><p>But a lot of these <code>.jar</code> files look like third party libraries that we might not want to spend time decompiling, at least not initially. We want to find the main logic implemented by the developers of the application we‚Äôre looking at to make the best use of our time.</p><p>To do this, I always check out the <code>web.xml</code> file, which should be in the <code>WEB-INF/</code> directory. This file is used by Java application servers to determine which classes to route traffic to. For example, the figure below shows a few interesting classes implementing servlets for the OpenCMS application. From what I‚Äôm seeing here, the <code>org.opencms</code> package is looking like a great place to start analyzing.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!-- Truncated for brevity ---&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;servlet&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;description&gt;</span>
</span></span><span style=display:flex><span>        The error handling servlet, also serves as trigger for static export requests.
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/description&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;servlet-name&gt;</span>OpenCmsServletErrorHandler<span style=color:#f92672>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;servlet-class&gt;</span>org.opencms.main.OpenCmsServletErrorHandler<span style=color:#f92672>&lt;/servlet-class&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;load-on-startup&gt;</span>0<span style=color:#f92672>&lt;/load-on-startup&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/servlet&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;servlet&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;description&gt;</span>
</span></span><span style=display:flex><span>        The main servlet that handles all requests to the OpenCms VFS.
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/description&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;servlet-name&gt;</span>OpenCmsServlet<span style=color:#f92672>&lt;/servlet-name&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;servlet-class&gt;</span>org.opencms.main.OpenCmsServlet<span style=color:#f92672>&lt;/servlet-class&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;load-on-startup&gt;</span>1<span style=color:#f92672>&lt;/load-on-startup&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/servlet&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!-- Truncated for brevity ---&gt;</span>
</span></span></code></pre></div><p>Now, we can use a simple grep to identify <code>.jar</code> files that implement the classes we care about. These matched <code>.jar</code> files seem like great candidates for handling the application‚Äôs main logic</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ grep -ir org.opencms WEB-INF/lib
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Binary file WEB-INF/lib/opencms-setup.jar matches
</span></span><span style=display:flex><span>Binary file WEB-INF/lib/org.opencms.locale.it.jar matches
</span></span><span style=display:flex><span>Binary file WEB-INF/lib/org.opencms.locale.de.jar matches
</span></span><span style=display:flex><span>Binary file WEB-INF/lib/org.opencms.locale.da.jar matches
</span></span><span style=display:flex><span>Binary file WEB-INF/lib/org.opencms.locale.es.jar matches
</span></span><span style=display:flex><span>Binary file WEB-INF/lib/org.opencms.locale.cs.jar matches
</span></span><span style=display:flex><span>Binary file WEB-INF/lib/org.opencms.locale.zh.jar matches
</span></span><span style=display:flex><span>Binary file WEB-INF/lib/opencms.jar matches
</span></span><span style=display:flex><span>Binary file WEB-INF/lib/opencms-resources.jar matches
</span></span><span style=display:flex><span>Binary file WEB-INF/lib/org.opencms.locale.ru.jar matches
</span></span><span style=display:flex><span>Binary file WEB-INF/lib/org.opencms.locale.ja.jar matches
</span></span><span style=display:flex><span>Binary file WEB-INF/lib/opencms-modules.jar matches
</span></span></code></pre></div><p>Next, let‚Äôs move those <code>.jar</code> files to a separate directory, since we‚Äôll focus on decompiling them first.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ mkdir jars-we-care-about <span style=color:#f92672>&amp;&amp;</span> grep -ir org.opencms WEB-INF/lib | awk <span style=color:#e6db74>&#39;{print $3}&#39;</span> | xargs -I<span style=color:#f92672>{}</span> cp <span style=color:#f92672>{}</span> jars-we-care-about
</span></span></code></pre></div><p>And we‚Äôve extracted the <code>.jar</code> files from our <code>.war</code> file! Let‚Äôs see how to do it with an <code>.apk</code> file, and then we‚Äôre ready to decompile.</p><h3 id=getting-jar-files-from-an-apk-file>Getting <code>.jar</code> Files From an <code>.apk</code> File<a hidden class=anchor aria-hidden=true href=#getting-jar-files-from-an-apk-file>#</a></h3><p>Getting JARs from an <code>.apk</code> file is a bit different because Android applications utilize the Dalvik Executable (‚ÄùDEX‚Äù) format to package Java classes and resources instead of JAR. However, the classes are compiled into the same (mostly, Dalvik bytecode is more optimized) bytecode. So, we can transform a <code>.dex</code> to a <code>.jar</code> file quite easily.</p><p>We can use <code>unzip</code> or <code>jar</code> once again to unpack the application and identify the <code>.dex</code> files within an <code>.apk</code> file. The figure below shows us identifying two <code>.dex</code> files for the Kahoot android application.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ jar xvf no.mobitroll.kahoot.android.apk
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>inflated: classes.dex   <span style=color:#75715e># Dex file</span>
</span></span><span style=display:flex><span>inflated: classes2.dex  <span style=color:#75715e># Dex file</span>
</span></span><span style=display:flex><span>inflated: lib/arm64-v8a/libpruneau.so
</span></span><span style=display:flex><span>inflated: lib/armeabi-v7a/libpruneau.so
</span></span><span style=display:flex><span>inflated: lib/x86/libpruneau.so
</span></span><span style=display:flex><span>inflated: lib/x86_64/libpruneau.so
</span></span><span style=display:flex><span>extracted: assets/audio/TheEnd.mp3
</span></span><span style=display:flex><span>extracted: assets/audio/alt02-answer_010sec.mp3
</span></span><span style=display:flex><span>extracted: assets/audio/alt02-answer_020sec.mp3
</span></span><span style=display:flex><span>extracted: assets/audio/alt02-answer_030sec.mp3
</span></span><span style=display:flex><span>extracted: assets/audio/alt03-answer_010sec.mp3
</span></span><span style=display:flex><span>extracted: assets/audio/alt03-answer_020sec.mp3
</span></span><span style=display:flex><span>extracted: assets/audio/alt03-answer_030sec.mp3
</span></span><span style=display:flex><span>extracted: assets/audio/alt03-answer_060sec.mp3
</span></span><span style=display:flex><span>extracted: assets/audio/alt03-answer_090sec.mp3
</span></span><span style=display:flex><span>extracted: assets/audio/alt03-answer_120sec.mp3
</span></span><span style=display:flex><span>extracted: assets/audio/answer_10sec.mp3
</span></span><span style=display:flex><span>extracted: assets/audio/answer_20sec.mp3
</span></span><span style=display:flex><span>extracted: assets/audio/answer_30sec.mp3
</span></span><span style=display:flex><span>extracted: assets/audio/content_slide_underscore.mp3
</span></span><span style=display:flex><span>extracted: assets/audio/correct_01.mp3
</span></span></code></pre></div><p>Next, we can use the <code>dex2jar</code> <a href=https://github.com/pxb1988/dex2jar>utility</a> to convert the <code>.dex</code> files to <code>.jar</code> files:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ d2j-dex2jar classes*
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>dex2jar classes.dex -&gt; ./classes-dex2jar.jar 
</span></span><span style=display:flex><span>dex2jar classes2.dex -&gt; ./classes2-dex2jar.jar
</span></span></code></pre></div><h2 id=4-decompile-the-jar-files>4. Decompile the <code>.jar</code> Files<a hidden class=anchor aria-hidden=true href=#4-decompile-the-jar-files>#</a></h2><p>With our desired <code>.jar</code> files in hand, it‚Äôs time to decompile them! IntelliJ comes with a great decompiler that you can call from the command line. Here‚Äôs how to do it on Mac:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ mkdir decompiled-jars-we-care-about <span style=color:#75715e># Make a new dir for decompiled jars</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ java -Xmx7066M -cp /Applications/IntelliJ<span style=color:#ae81ff>\ </span>IDEA<span style=color:#ae81ff>\ </span>CE.app/Contents/plugins/java-decompiler/lib/java-decompiler.jar org.jetbrains.java.decompiler.main.decompiler.ConsoleDecompiler -mpm<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span> jars-we-care-about decompiled-jars-we-care-about
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>INFO:  Decompiling class org/opencms/module/CmsModuleDependency
</span></span><span style=display:flex><span>INFO:  ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>INFO:  Decompiling class org/opencms/module/CmsModuleImportExportRepository
</span></span><span style=display:flex><span>INFO:  ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>INFO:  Decompiling class org/opencms/module/CmsModuleUpdater
</span></span><span style=display:flex><span>INFO:  ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>INFO:  Decompiling class org/opencms/module/CmsResourceImportData
</span></span><span style=display:flex><span>INFO:  ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>INFO:  Decompiling class org/opencms/module/CmsModuleVersion
</span></span><span style=display:flex><span>INFO:  ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>INFO:  Decompiling class org/opencms/module/CmsReplaceModuleInfo
</span></span><span style=display:flex><span>INFO:  ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>INFO:  Decompiling class org/opencms/module/CmsModuleXmlHandler
</span></span><span style=display:flex><span>INFO:  ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>INFO:  Decompiling class org/opencms/module/CmsModuleManager
</span></span><span style=display:flex><span>INFO:  ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>INFO:  Decompiling class org/opencms/module/CmsModule
</span></span><span style=display:flex><span>INFO:  ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>INFO:  Decompiling class org/opencms/module/Messages
</span></span><span style=display:flex><span>INFO:  ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>INFO:  Decompiling class org/opencms/module/CmsModuleImportData
</span></span><span style=display:flex><span><span style=color:#75715e># Truncated for brevity...</span>
</span></span></code></pre></div><p>Now, we can unpack the decompiled <code>.jar</code> files to reveal the decompiled Java source code inside!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ cd decompiled-jars-we-care-about
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ find . -name <span style=color:#e6db74>&#34;*.jar&#34;</span> | xargs -I<span style=color:#f92672>{}</span> jar xvf <span style=color:#f92672>{}</span>  <span style=color:#75715e># Unpack all the decompiled JARs</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>inflated: META-INF/MANIFEST.MF
</span></span><span style=display:flex><span>created: META-INF/
</span></span><span style=display:flex><span>created: org/
</span></span><span style=display:flex><span>created: org/opencms/
</span></span><span style=display:flex><span>created: org/opencms/setup/
</span></span><span style=display:flex><span>created: org/opencms/setup/ui/
</span></span><span style=display:flex><span>created: org/opencms/setup/db/
</span></span><span style=display:flex><span>created: org/opencms/setup/db/update6to7/
</span></span><span style=display:flex><span>created: org/opencms/setup/db/update6to7/oracle/
</span></span><span style=display:flex><span>created: org/opencms/setup/db/update6to7/postgresql/
</span></span><span style=display:flex><span>created: org/opencms/setup/db/update6to7/mysql/
</span></span><span style=display:flex><span>created: org/opencms/setup/db/update7to8/
</span></span><span style=display:flex><span>created: org/opencms/setup/db/update7to8/oracle/
</span></span><span style=display:flex><span>created: org/opencms/setup/db/update7to8/postgresql/
</span></span><span style=display:flex><span>created: org/opencms/setup/db/update7to8/mysql/
</span></span><span style=display:flex><span>created: org/opencms/setup/updater/
</span></span><span style=display:flex><span>created: org/opencms/setup/updater/dialogs/
</span></span><span style=display:flex><span>created: org/opencms/setup/xml/
</span></span><span style=display:flex><span>created: org/opencms/setup/comptest/
</span></span><span style=display:flex><span>inflated: org/opencms/setup/ui/CmsSetupStep02ComponentCheck.html
</span></span><span style=display:flex><span>inflated: org/opencms/setup/ui/CmsSetupErrorDialog.html
</span></span><span style=display:flex><span>inflated: org/opencms/setup/ui/CmsSetupStep03Database.html
</span></span><span style=display:flex><span>inflated: org/opencms/setup/ui/CmsSetupStep01License.html
</span></span><span style=display:flex><span>inflated: org/opencms/setup/ui/CmsSetupStep06ImportReport.html
</span></span><span style=display:flex><span>inflated: org/opencms/setup/ui/CmsSetupStep07ConfigNotes.html
</span></span><span style=display:flex><span>inflated: org/opencms/setup/ui/CmsSetupStep05ServerSettings.html
</span></span><span style=display:flex><span>inflated: org/opencms/setup/ui/CmsSetupStep04Modules.html
</span></span><span style=display:flex><span>inflated: org/opencms/setup/ui/CmsDbSettingsPanel.html
</span></span><span style=display:flex><span><span style=color:#75715e># Truncated for brevity...</span>
</span></span></code></pre></div><p>We‚Äôre left with <code>.java</code> source files!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ find . -name <span style=color:#e6db74>&#34;*.java&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>./org/opencms/cmis/CmsCmisTypeManager.java
</span></span><span style=display:flex><span>./org/opencms/cmis/I_CmsCmisObjectHelper.java
</span></span><span style=display:flex><span>./org/opencms/cmis/CmsCmisService.java
</span></span><span style=display:flex><span>./org/opencms/cmis/A_CmsCmisRepository.java
</span></span><span style=display:flex><span>./org/opencms/cmis/I_CmsCmisRenditionProvider.java
</span></span><span style=display:flex><span>./org/opencms/cmis/CmsCmisCallContext.java
</span></span><span style=display:flex><span>./org/opencms/cmis/I_CmsCmisRepository.java
</span></span><span style=display:flex><span>./org/opencms/cmis/CmsCmisRelationHelper.java
</span></span><span style=display:flex><span>./org/opencms/cmis/CmsObjectListLimiter.java
</span></span><span style=display:flex><span>./org/opencms/cmis/CmsCmisResourceHelper.java
</span></span><span style=display:flex><span>./org/opencms/cmis/CmsCmisServiceFactory.java
</span></span><span style=display:flex><span>./org/opencms/cmis/CmsCmisRenditionFilter.java
</span></span><span style=display:flex><span>./org/opencms/cmis/I_CmsPropertyProvider.java
</span></span><span style=display:flex><span>./org/opencms/cmis/CmsCmisUtil.java
</span></span><span style=display:flex><span>./org/opencms/cmis/CmsCmisRepository.java
</span></span><span style=display:flex><span>./org/opencms/ui/I_CmsHasButtons.java
</span></span><span style=display:flex><span>./org/opencms/ui/I_CmsEditPropertyContext.java
</span></span><span style=display:flex><span>./org/opencms/ui/I_CmsUpdateListener.java
</span></span><span style=display:flex><span>./org/opencms/ui/CmsVaadinErrorHandler.java
</span></span><span style=display:flex><span>./org/opencms/ui/CmsUserIconHelper.java
</span></span><span style=display:flex><span>./org/opencms/ui/util/CmsComboNullToEmptyConverter.java
</span></span><span style=display:flex><span>./org/opencms/ui/util/CmsStyleVariable.java
</span></span><span style=display:flex><span>./org/opencms/ui/util/CmsLogicalCheckboxGroup.java
</span></span><span style=display:flex><span>./org/opencms/ui/util/CmsDisplayType.java
</span></span><span style=display:flex><span>./org/opencms/ui/util/CmsNewResourceBuilder.java
</span></span><span style=display:flex><span><span style=color:#75715e># Truncated for brevity...</span>
</span></span></code></pre></div><h2 id=5-set-up-your-ide>5. Set Up Your IDE<a hidden class=anchor aria-hidden=true href=#5-set-up-your-ide>#</a></h2><p>Now that we have (basically) Java source code, it‚Äôs time to load it into our IDE and start finding vulnerabilities.</p><h3 id=open-your-decompiled-java-code>Open Your Decompiled Java Code<a hidden class=anchor aria-hidden=true href=#open-your-decompiled-java-code>#</a></h3><p>First, fire up IntelliJ and click <strong><strong><strong><strong><strong>Open.</strong></strong></strong></strong></strong></p><p><img alt="Opening a Project in IntelliJ" loading=lazy src=/opening-a-project-in-intellij.png></p><p>Now, select the directory of decompiled and expanded <code>.jar</code> files we created.</p><p><img alt="Selecting JAR Files in IntelliJ" loading=lazy src=/selecting-jar-files-in-intellij.png></p><h3 id=resolve-dependencies>Resolve Dependencies<a hidden class=anchor aria-hidden=true href=#resolve-dependencies>#</a></h3><p>This is where <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>the true magic happens</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>. We‚Äôre going to point IntelliJ to the original <code>.jar</code> files we extracted, (not the decompiled ones) and it is going to allow us to resolve the application‚Äôs dependencies to perform in-depth static analysis.</p><p>Go to <strong><strong><strong><strong><strong><strong><strong><strong><strong>File ‚Üí Project Structure‚Ä¶</strong></strong></strong></strong></strong></strong></strong></strong></strong> and, firstly, select a Java SDK that makes sense for the project you‚Äôre analyzing. Be sure to click <strong><strong><strong><strong><strong>Apply</strong></strong></strong></strong></strong>.</p><p><img alt="Selecting Java SDK" loading=lazy src=/selecting-java-sdk.png></p><p>Next, go the <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>Libraries</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong> tab and click <strong><strong>-</strong></strong> to remove any current dependencies, as these are decompiled <code>.jar</code>s and won‚Äôt resolve things properly.</p><p><img alt="Deselecting Decompiled JARs" loading=lazy src=/deselecting-decompiled-jars.png></p><p>Click <strong><strong>+</strong></strong> to add a new project library and choose <strong><strong><strong><strong>Java</strong></strong></strong></strong>:</p><p><img alt="Adding New Project Library" loading=lazy src=/adding-new-project-library.png></p><p>Select the folder containing the original, compiled <code>.jar</code> files. Include the third party dependencies, we want to be able to resolve them too!</p><p><img alt="Resolving Dependencies" loading=lazy src=/resolving-dependencies.png></p><p>Hit <strong><strong><strong><strong><strong><strong>Apply</strong></strong></strong></strong></strong></strong> and then <strong><strong><strong>OK</strong></strong></strong>.</p><p><img alt="Apply and Ok" loading=lazy src=/apply-and-ok.png></p><h3 id=additional-unresolved-dependencies>Additional Unresolved Dependencies<a hidden class=anchor aria-hidden=true href=#additional-unresolved-dependencies>#</a></h3><p>It‚Äôs possible that after adding all the original <code>.jar</code>s as libraries, you‚Äôll still have some unresolved dependencies within your project. These will show up red within IntelliJ.</p><p><img alt="Broken Dependencies" loading=lazy src=/broken-dependencies.png></p><p>This is likely because the application you are analyzing assumes that the system running it will have these dependencies on its class path already. For example, an Android APK should expect the Android SDK to be present, and a web application should expect the <code>javax.servlet</code> package to be present.</p><p>Sometimes, you can resolve these dependencies quickly by clicking on the red lightbulb within IntelliJ and then <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>Find JAR on web</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong>.</p><p><img alt="Find JAR on Web" loading=lazy src=/find-jar-on-web.png></p><p>Otherwise, you can navigate back to <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>File ‚Üí Project Structure‚Ä¶</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong> and add a new library from Maven (the Java package manager).</p><p><img alt="Add Library from Maven" loading=lazy src=/add-library-from-maven.png></p><p>Search for and select the dependency you need to resolve. IntelliJ will download the <code>.jar</code> from Maven and add it to your project.</p><p><img alt="Completing JAR Download" loading=lazy src=/completing-jar-download.png></p><h2 id=6-profit>6. Profit!<a hidden class=anchor aria-hidden=true href=#6-profit>#</a></h2><p>I know it took a bit to get here, but by investing time up front, you are now prepared to find vulnerabilities that simply wouldn‚Äôt be possible otherwise.</p><h3 id=finding-usages>Finding Usages<a hidden class=anchor aria-hidden=true href=#finding-usages>#</a></h3><p>One of the pain points of manual static analysis is the tedious process of tracing user-controllable input through the application. Well, with our current setup, we have made our lives much easier. We can click on any variable, method, or class and find all of its assignments and usages throughout the application. For example, we might want to understand how the class variable <code>m_settings</code> is being used throughout the application:</p><p><img alt="Find Usages Usage" loading=lazy src=/find-usages-usage.png></p><p>IntelliJ&rsquo;s ability to map out all read and write occurrences of a variable in question greatly speeds up manual static analysis.</p><p><img alt="Read and Write Occurrences" loading=lazy src=/read-and-write-occurrences.png></p><h3 id=data-flow-analysis>Data Flow Analysis<a hidden class=anchor aria-hidden=true href=#data-flow-analysis>#</a></h3><p>IntelliJ goes behind just finding usages, though. It can fully map out the flow of data within the application. To do this, we right click on a variable and go to <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>Analyze ‚Üí Data Flow to Here‚Ä¶ or Data Flow from Here‚Ä¶</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong> Below, we are doing this to understand how the <code>req</code> variable of the <code>doGet()</code> method of an HTTP servlet is being used.</p><p><img alt="Data Flow Usage" loading=lazy src=/data-flow-usage.png></p><p>We can then easily view all the places the <code>req</code> variable is passed into other functions within the rest of the application in one single place. This is extremely useful during static analysis.</p><p><img alt="Viewing Data Flow" loading=lazy src=/viewing-data-flow.png></p><h3 id=sink-to-source-analysis>Sink-to-Source Analysis<a hidden class=anchor aria-hidden=true href=#sink-to-source-analysis>#</a></h3><p>With these tools under our belt, we have to ability to find truly impactful vulnerabilities. We can leverage <strong>source-to-sink analysis</strong>, (also called taint analysis) where we trace the flow of data from dangerous functions back to parameters we control. For a more in-depth definition of source-to-sink analysis, check out one of my previous blog posts: <a href=https://www.mandiant.com/resources/blog/route-sixty-sink-launch>https://www.mandiant.com/resources/blog/route-sixty-sink-launch</a>.</p><p>For example, let‚Äôs say we want to look for <a href=https://cheatsheetseries.owasp.org/cheatsheets/Deserialization_Cheat_Sheet.html>unsafe deserialization vulnerabilities</a> (they just so happen to be one of my favorite vulnerability classes). We know that a call to <code>java.io.ObjectInputStream::ReadObject()</code> on attacker-controlled data can result in SSRF, file access, or even remote code execution. Let‚Äôs see how to search for Java object deserialization within our application:</p><p>First, enter <strong><strong><strong><strong><strong><strong>‚åò + O</strong></strong></strong></strong></strong></strong> and search for the <code>java.io.ObjectInputStream</code> class:</p><p><img alt="Searching For ObjectInputStream" loading=lazy src=/searching-for-object-input-stream.png></p><p>Identify the <code>readObject()</code> method and view its data flow throughout the application:</p><p><img alt="Read Object Data Flow" loading=lazy src=/read-object-data-flow.png></p><p>We immediately have a detailed call graph leading to our sink. If we can trace it to input that we control as an attacker, (an HTTP parameter, header, etc.) we‚Äôve found a vulnerability!</p><p><img alt="Data Flow Results" loading=lazy src=/data-flow-results.png></p><p>Thanks for reading! Keep an eye out for more security content coming your way soon! Stay safe out there! üîíüíªüë®‚Äçüíª</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://www.dillonfrankesecurity.com/posts/protoburp-encode-custom-protobuf-messages-in-burp/><span class=title>¬´ Prev</span><br><span>ProtoBurp: Encode and Fuzz Custom Protobuf Messages in Burp Suite</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Java Static Vulnerability Analysis to Increase Your Bounty on x" href="https://x.com/intent/tweet/?text=Java%20Static%20Vulnerability%20Analysis%20to%20Increase%20Your%20Bounty&amp;url=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fjava-static-vulnerability-analysis-to-increase-your-bounty%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Java Static Vulnerability Analysis to Increase Your Bounty on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fjava-static-vulnerability-analysis-to-increase-your-bounty%2f&amp;title=Java%20Static%20Vulnerability%20Analysis%20to%20Increase%20Your%20Bounty&amp;summary=Java%20Static%20Vulnerability%20Analysis%20to%20Increase%20Your%20Bounty&amp;source=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fjava-static-vulnerability-analysis-to-increase-your-bounty%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Java Static Vulnerability Analysis to Increase Your Bounty on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fjava-static-vulnerability-analysis-to-increase-your-bounty%2f&title=Java%20Static%20Vulnerability%20Analysis%20to%20Increase%20Your%20Bounty"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Java Static Vulnerability Analysis to Increase Your Bounty on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fjava-static-vulnerability-analysis-to-increase-your-bounty%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Java Static Vulnerability Analysis to Increase Your Bounty on whatsapp" href="https://api.whatsapp.com/send?text=Java%20Static%20Vulnerability%20Analysis%20to%20Increase%20Your%20Bounty%20-%20https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fjava-static-vulnerability-analysis-to-increase-your-bounty%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Java Static Vulnerability Analysis to Increase Your Bounty on telegram" href="https://telegram.me/share/url?text=Java%20Static%20Vulnerability%20Analysis%20to%20Increase%20Your%20Bounty&amp;url=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fjava-static-vulnerability-analysis-to-increase-your-bounty%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Java Static Vulnerability Analysis to Increase Your Bounty on ycombinator" href="https://news.ycombinator.com/submitlink?t=Java%20Static%20Vulnerability%20Analysis%20to%20Increase%20Your%20Bounty&u=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fjava-static-vulnerability-analysis-to-increase-your-bounty%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//dillon-franke-blog.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2025 <a href=https://www.dillonfrankesecurity.com/>Dillon Franke Security</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>
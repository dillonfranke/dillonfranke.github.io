<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><link rel=stylesheet href=https://use.typekit.net/xdt6zgj.css><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ProtoBurp: Encode and Fuzz Custom Protobuf Messages in Burp Suite | Dillon Franke Security</title>
<meta name=keywords content><meta name=description content="Background Protocol Buffers (Protobufs) are a language agnostic data serialization format that allow data to be safely and efficiently trasmitted or stored. Protobuf usage has exploded within the past several years. When testing web applications, mobile applications, and embedded devices alike, it&rsquo;s increasingly likely you&rsquo;ll encounter Protobuf data within requests like this:
A normal binary Protobuf request
You might have logically tried to fuzz these inputs as you would any other parameter, only to realize that things weren&rsquo;t as simple as they appeared:"><meta name=author content><link rel=canonical href=https://www.dillonfrankesecurity.com/posts/protoburp-encode-custom-protobuf-messages-in-burp/><link crossorigin=anonymous href=/assets/css/stylesheet.a5f8f58a3d3d53d9337d4941ef77fb54ac2ecf51b7be756b2ee3bb485ceb7e7a.css integrity="sha256-pfj1ij09U9kzfUlB73f7VKwuz1G3vnVrLuO7SFzrfno=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://www.dillonfrankesecurity.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.dillonfrankesecurity.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.dillonfrankesecurity.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.dillonfrankesecurity.com/apple-touch-icon.png><link rel=mask-icon href=https://www.dillonfrankesecurity.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script defer data-domain=dillonfrankesecurity.com src=https://plausible.io/js/script.js></script><meta property="og:title" content="ProtoBurp: Encode and Fuzz Custom Protobuf Messages in Burp Suite"><meta property="og:description" content="Background Protocol Buffers (Protobufs) are a language agnostic data serialization format that allow data to be safely and efficiently trasmitted or stored. Protobuf usage has exploded within the past several years. When testing web applications, mobile applications, and embedded devices alike, it&rsquo;s increasingly likely you&rsquo;ll encounter Protobuf data within requests like this:
A normal binary Protobuf request
You might have logically tried to fuzz these inputs as you would any other parameter, only to realize that things weren&rsquo;t as simple as they appeared:"><meta property="og:type" content="article"><meta property="og:url" content="https://www.dillonfrankesecurity.com/posts/protoburp-encode-custom-protobuf-messages-in-burp/"><meta property="og:image" content="https://www.dillonfrankesecurity.com/introducing-protoburp.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-02T14:22:41-07:00"><meta property="article:modified_time" content="2023-08-02T14:22:41-07:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.dillonfrankesecurity.com/introducing-protoburp.jpg"><meta name=twitter:title content="ProtoBurp: Encode and Fuzz Custom Protobuf Messages in Burp Suite"><meta name=twitter:description content="Background Protocol Buffers (Protobufs) are a language agnostic data serialization format that allow data to be safely and efficiently trasmitted or stored. Protobuf usage has exploded within the past several years. When testing web applications, mobile applications, and embedded devices alike, it&rsquo;s increasingly likely you&rsquo;ll encounter Protobuf data within requests like this:
A normal binary Protobuf request
You might have logically tried to fuzz these inputs as you would any other parameter, only to realize that things weren&rsquo;t as simple as they appeared:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://www.dillonfrankesecurity.com/posts/"},{"@type":"ListItem","position":3,"name":"ProtoBurp: Encode and Fuzz Custom Protobuf Messages in Burp Suite","item":"https://www.dillonfrankesecurity.com/posts/protoburp-encode-custom-protobuf-messages-in-burp/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ProtoBurp: Encode and Fuzz Custom Protobuf Messages in Burp Suite","name":"ProtoBurp: Encode and Fuzz Custom Protobuf Messages in Burp Suite","description":"Background Protocol Buffers (Protobufs) are a language agnostic data serialization format that allow data to be safely and efficiently trasmitted or stored. Protobuf usage has exploded within the past several years. When testing web applications, mobile applications, and embedded devices alike, it\u0026rsquo;s increasingly likely you\u0026rsquo;ll encounter Protobuf data within requests like this:\nA normal binary Protobuf request\nYou might have logically tried to fuzz these inputs as you would any other parameter, only to realize that things weren\u0026rsquo;t as simple as they appeared:","keywords":[],"articleBody":"Background Protocol Buffers (Protobufs) are a language agnostic data serialization format that allow data to be safely and efficiently trasmitted or stored. Protobuf usage has exploded within the past several years. When testing web applications, mobile applications, and embedded devices alike, it’s increasingly likely you’ll encounter Protobuf data within requests like this:\nA normal binary Protobuf request\nYou might have logically tried to fuzz these inputs as you would any other parameter, only to realize that things weren’t as simple as they appeared:\nNaively fuzzing binary protobuf data doesn’t work\nAdditionally, you might have discovered a Protobuf definition (.proto) file like the one below and wondered how you could use such a file to send valid, fuzzable requests. If so, ProtoBurp was made for you ❤️\nsyntax = \"proto3\"; package tutorial; message Person { string name = 1; int32 id = 2; string email = 3; enum PhoneType { PHONE_TYPE_UNSPECIFIED = 0; PHONE_TYPE_MOBILE = 1; PHONE_TYPE_HOME = 2; PHONE_TYPE_WORK = 3; } message PhoneNumber { string number = 1; PhoneType type = 2; } repeated PhoneNumber phones = 4; } message AddressBook { repeated Person people = 1; } Introducing ProtoBurp ProtoBurp is a Burp Suite extension that enables security researchers to encode and fuzz custom Protobuf messages. It allows users to automatically convert JSON data into a Protobuf message based on a provided protobuf definition file. This opens up opportunities for fuzzing inputs using Burp’s Repeater and Intruder tools, as well as proxy traffic from other tools (e.g. sqlmap).\nProtoBurp converts JSON data into a valid Protobuf\nHow do I use ProtoBurp? The magic behind ProtoBurp lies in its ability to dynamically create Protobuf messages based on provided JSON input and a Protobuf definition file.\nThe ProtoBurp extension tab in Burp Suite\nInstall ProtoBurp and its dependencies (see the GitHub repository) Create or obtain a .proto file you’d like to use to serialize Protobuf messages (examples are in the test_app folder). Use the protoc utility to compile your .proto file into Python format protoc --python_out=./ MyMessage.proto Click the ‘Choose File’ button to select your compiled protobuf file. Check the ‘Enable ProtoBurp’ checkbox. All requests sent with the header ProtoBurp: True will then be converted from JSON to a Protobuf! Usage with Intruder Once you have ProtoBurp set up, you can fuzz Protobuf inputs with Burp just like you would any other parameter! For example, to fuzz the number field we’ve seen in the previous examples, we can just send our JSON payload request to Intruder:\nBurp Suite Intruder usage\nFor each fuzzed request Intruder makes, ProtoBurp will handle the conversion from JSON into Protobuf format:\nIntruder requests converted into Protobuf data\nNote: The modified requests won’t show up in Burp’s proxy history. You’ll need to view the outgoing requests using Burp’s Logger or an extension like Logger++, as I did above.\nUsage with sqlmap (or any external tool) Possibly the largest motivator for creating ProtoBurp was to generate a way to seamlessly use external security tools on Protobuf inputs. For example, during one web application assessment, I identified an OR-based SQL injection in a Protobuf field, as shown below.\nSuccessful OR-based SQL injection\nNormally, my next step would be to pass this request to sqlmap and have the database fully dumped within 30 minutes. However, I couldn’t do this because of the pesky Protobufs.\nBut now enter ProtoBurp. It is now possible to give sqlmap a JSON object to insert payloads into and let ProtoBurp handle the Protobuf encoding. We can now use the following command:\nsqlmap -u http://chickenblasters.com:5000 --force-ssl --level 5 --risk 3 -H \"ProtoBurp: true\" --batch --proxy=http://localhost:8080 --data='{\"people\":[{\"name\":\"JohnDoe\",\"id\":1,\"email\":\"john.doe@example.com\",\"phones\":[{\"number\":\"1234567890*\",\"type\":\"PHONE_TYPE_MOBILE\"},{\"number\":\"0987654321\",\"type\":\"PHONE_TYPE_HOME\"}]}]}' Note: Make sure to set the ProtoBurp: True header!\nAll proxy traffic from sqlmap is then converted by ProtoBurp:\nSqlmap payloads converted by ProtoBurp\nGenerating a JSON payload You might be wondering: “How can I generate a JSON object from a .proto file to use with ProtoBurp?”\nEasy, I wrote a script that, given a .proto file, will fill in placeholder values to generate a JSON payload. You can then use the JSON payload with ProtoBurp. Here’s how you use the script:\n❯ python3 json-generator.py Usage: python3 json-generator.py ❯ python3 json-generator.py test_app/addressbook_pb2.py AddressBook { \"people\": [ { \"name\": \"example\", \"id\": 1, \"email\": \"example\", \"phones\": [ { \"number\": \"example\", \"type\": \"PHONE_TYPE_UNSPECIFIED\" }, { \"number\": \"example\", \"type\": \"PHONE_TYPE_UNSPECIFIED\" } ] }, { \"name\": \"example\", \"id\": 1, \"email\": \"example\", \"phones\": [ { \"number\": \"example\", \"type\": \"PHONE_TYPE_UNSPECIFIED\" }, { \"number\": \"example\", \"type\": \"PHONE_TYPE_UNSPECIFIED\" } ] } ] } What about existing tooling? I’ve used the blackboxprotobuf Burp extension for years, which aids in the decoding, editing, and re-encoding of Protobuf messages without known .proto files. For example, the figure below shows the Protobuf from above decoded by blackboxprotobuf.\nThe Blackboxprotobuf extension in action\nWhile it is an excellent tool, one of blackboxprotobuf’s notable limitations is the fact that it can only send protobuf messages it has previously seen through Burp Suite’s proxy. Sometimes, however, researchers want to send new protobuf messages, either because we want to fuzz them, or we know the format of a specific message.\nProtoBurp solves two novel problems:\nThe ability to send new protobuf messages that weren’t already seen through proxy traffic Operability with Burp Intruder and other extensions to fuzz protobuf inputs ProtoBurp GitHub Repository You can access ProtoBurp, the JSON generator script, and a test application that accepts Protobufs here. Detailed installation and usage instructions are also included.\nPlease submit any bugs or feature requests to ProtoBurp’s issue tracker.\nThanks for reading, and I wish you much success testing Protobufs!\n","wordCount":"925","inLanguage":"en","image":"https://www.dillonfrankesecurity.com/introducing-protoburp.jpg","datePublished":"2023-08-02T14:22:41-07:00","dateModified":"2023-08-02T14:22:41-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.dillonfrankesecurity.com/posts/protoburp-encode-custom-protobuf-messages-in-burp/"},"publisher":{"@type":"Organization","name":"Dillon Franke Security","logo":{"@type":"ImageObject","url":"https://www.dillonfrankesecurity.com/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.dillonfrankesecurity.com accesskey=h title="Dillon Franke Security (Alt + H)">Dillon Franke Security</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.dillonfrankesecurity.com/ title=Home><span>Home</span></a></li><li><a href=https://www.dillonfrankesecurity.com/posts/ title=Blog><span>Blog</span></a></li><li><a href=https://www.dillonfrankesecurity.com/presentations/ title=Presentations><span>Presentations</span></a></li><li><a href=https://www.dillonfrankesecurity.com/services/ title=Services><span>Services</span></a></li><li><a href=https://www.dillonfrankesecurity.com/contact/ title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>ProtoBurp: Encode and Fuzz Custom Protobuf Messages in Burp Suite</h1><div class=post-meta><span title='2023-08-02 14:22:41 -0700 -0700'>August 2, 2023</span>&nbsp;·&nbsp;5 min</div></header><figure class=entry-cover><img loading=lazy src=https://www.dillonfrankesecurity.com/introducing-protoburp.jpg alt></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#background aria-label=Background>Background</a></li><li><a href=#introducing-protoburp aria-label="Introducing ProtoBurp">Introducing ProtoBurp</a><ul><li><a href=#how-do-i-use-protoburp aria-label="How do I use ProtoBurp?">How do I use ProtoBurp?</a><ul><li><a href=#usage-with-intruder aria-label="Usage with Intruder">Usage with Intruder</a></li><li><a href=#usage-with-sqlmap-or-any-external-tool aria-label="Usage with sqlmap (or any external tool)">Usage with sqlmap (or any external tool)</a></li><li><a href=#generating-a-json-payload aria-label="Generating a JSON payload">Generating a JSON payload</a></li></ul></li><li><a href=#what-about-existing-tooling aria-label="What about existing tooling?">What about existing tooling?</a></li></ul></li><li><a href=#protoburp-github-repository aria-label="ProtoBurp GitHub Repository">ProtoBurp GitHub Repository</a></li></ul></div></details></div><div class=post-content><h1 id=background>Background<a hidden class=anchor aria-hidden=true href=#background>#</a></h1><p>Protocol Buffers (Protobufs) are a language agnostic data serialization format that allow data to be safely and efficiently trasmitted or stored. Protobuf usage has exploded within the past several years. When testing web applications, mobile applications, and embedded devices alike, it&rsquo;s increasingly likely you&rsquo;ll encounter Protobuf data within requests like this:</p><figure><img loading=lazy src=/normal-protobuf-binary-request.png alt="Normal binary Protobuf request"><figcaption><p>A normal binary Protobuf request</p></figcaption></figure><p>You might have logically tried to fuzz these inputs as you would any other parameter, only to realize that things weren&rsquo;t as simple as they appeared:</p><figure><img loading=lazy src=/naively-fuzzing-protobuf-binary-data.png alt="Naively fuzzing binary Protobuf data"><figcaption><p>Naively fuzzing binary protobuf data doesn&rsquo;t work</p></figcaption></figure><p>Additionally, you might have discovered a Protobuf definition (<code>.proto</code>) file like the one below and wondered how you could use such a file to send valid, fuzzable requests. If so, <code>ProtoBurp</code> was made for you ❤️</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-protobuf data-lang=protobuf><span style=display:flex><span>syntax <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;proto3&#34;</span>;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#f92672>package</span> tutorial;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>message</span> <span style=color:#a6e22e>Person</span> {<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#66d9ef>string</span> name <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#66d9ef>int32</span> id <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#66d9ef>string</span> email <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#66d9ef>enum</span> PhoneType {<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>    PHONE_TYPE_UNSPECIFIED <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>    PHONE_TYPE_MOBILE <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>    PHONE_TYPE_HOME <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>    PHONE_TYPE_WORK <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  }<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#66d9ef>message</span> <span style=color:#a6e22e>PhoneNumber</span> {<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>    <span style=color:#66d9ef>string</span> number <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>    PhoneType type <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  }<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#66d9ef>repeated</span> PhoneNumber phones <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>}<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>message</span> <span style=color:#a6e22e>AddressBook</span> {<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>  <span style=color:#66d9ef>repeated</span> Person people <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;<span style=color:#960050;background-color:#1e0010>
</span></span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010></span>}<span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><h1 id=introducing-protoburp>Introducing ProtoBurp<a hidden class=anchor aria-hidden=true href=#introducing-protoburp>#</a></h1><p><code>ProtoBurp</code> is a Burp Suite extension that enables security researchers to encode and fuzz custom Protobuf messages. It allows users to automatically convert JSON data into a Protobuf message based on a provided protobuf definition file. This opens up opportunities for fuzzing inputs using Burp&rsquo;s Repeater and Intruder tools, as well as proxy traffic from other tools (e.g. <code>sqlmap</code>).</p><figure><img loading=lazy src=/protoburp-transformation.png alt="Protoburp's functionality"><figcaption><p>ProtoBurp converts JSON data into a valid Protobuf</p></figcaption></figure><h2 id=how-do-i-use-protoburp>How do I use ProtoBurp?<a hidden class=anchor aria-hidden=true href=#how-do-i-use-protoburp>#</a></h2><p>The magic behind <code>ProtoBurp</code> lies in its ability to dynamically create Protobuf messages based on provided JSON input and a Protobuf definition file.</p><figure><img loading=lazy src=/protoburp-extension-tab.png alt="Protoburp extension tab in Burp Suite"><figcaption><p>The ProtoBurp extension tab in Burp Suite</p></figcaption></figure><ol><li>Install ProtoBurp and its dependencies (see the <a href=https://github.com/dillonfranke/protoburp>GitHub repository</a>)</li><li>Create or obtain a <code>.proto</code> file you&rsquo;d like to use to serialize Protobuf messages (examples are in the <code>test_app</code> folder).</li><li>Use the <code>protoc</code> utility to compile your <code>.proto</code> file into Python format</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>protoc --python_out<span style=color:#f92672>=</span>./ MyMessage.proto
</span></span></code></pre></div><ol start=4><li>Click the &lsquo;Choose File&rsquo; button to select your compiled protobuf file.</li><li>Check the &lsquo;Enable ProtoBurp&rsquo; checkbox.</li><li>All requests sent with the header <code>ProtoBurp: True</code> will then be converted from JSON to a Protobuf!</li></ol><h3 id=usage-with-intruder>Usage with Intruder<a hidden class=anchor aria-hidden=true href=#usage-with-intruder>#</a></h3><p>Once you have <code>ProtoBurp</code> set up, you can fuzz Protobuf inputs with Burp just like you would any other parameter! For example, to fuzz the <code>number</code> field we&rsquo;ve seen in the previous examples, we can just send our JSON payload request to Intruder:</p><figure><img loading=lazy src=/burp-intruder-usage.png alt="Burp Suite Intruder usage" height=600><figcaption><p>Burp Suite Intruder usage</p></figcaption></figure><p>For each fuzzed request Intruder makes, <code>ProtoBurp</code> will handle the conversion from JSON into Protobuf format:</p><figure><img loading=lazy src=/burp-intruder-usage-requests.png alt="Converted Intruder requests" height=600><figcaption><p>Intruder requests converted into Protobuf data</p></figcaption></figure><blockquote><p><strong>Note:</strong> The modified requests won&rsquo;t show up in Burp&rsquo;s proxy history. You&rsquo;ll need to view the outgoing requests using Burp&rsquo;s <code>Logger</code> or an extension like <code>Logger++</code>, as I did above.</p></blockquote><h3 id=usage-with-sqlmap-or-any-external-tool>Usage with sqlmap (or any external tool)<a hidden class=anchor aria-hidden=true href=#usage-with-sqlmap-or-any-external-tool>#</a></h3><p>Possibly the largest motivator for creating <code>ProtoBurp</code> was to generate a way to seamlessly use external security tools on Protobuf inputs. For example, during one web application assessment, I identified an OR-based SQL injection in a Protobuf field, as shown below.</p><figure><img loading=lazy src=/or-based-sql-injection.png alt="Successful OR-based SQLi"><figcaption><p>Successful OR-based SQL injection</p></figcaption></figure><p>Normally, my next step would be to pass this request to <code>sqlmap</code> and have the database fully dumped within 30 minutes. However, I couldn&rsquo;t do this because of the pesky Protobufs.</p><p>But now enter <code>ProtoBurp</code>. It is now possible to give <code>sqlmap</code> a JSON object to insert payloads into and let <code>ProtoBurp</code> handle the Protobuf encoding. We can now use the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sqlmap -u http://chickenblasters.com:5000 --force-ssl --level <span style=color:#ae81ff>5</span> --risk <span style=color:#ae81ff>3</span> -H <span style=color:#e6db74>&#34;ProtoBurp: true&#34;</span> --batch --proxy<span style=color:#f92672>=</span>http://localhost:8080 --data<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;{&#34;people&#34;:[{&#34;name&#34;:&#34;JohnDoe&#34;,&#34;id&#34;:1,&#34;email&#34;:&#34;john.doe@example.com&#34;,&#34;phones&#34;:[{&#34;number&#34;:&#34;1234567890*&#34;,&#34;type&#34;:&#34;PHONE_TYPE_MOBILE&#34;},{&#34;number&#34;:&#34;0987654321&#34;,&#34;type&#34;:&#34;PHONE_TYPE_HOME&#34;}]}]}&#39;</span>
</span></span></code></pre></div><blockquote><p><strong>Note</strong>: Make sure to set the <code>ProtoBurp: True</code> header!</p></blockquote><p>All proxy traffic from <code>sqlmap</code> is then converted by <code>ProtoBurp</code>:</p><figure><img loading=lazy src=/sqlmap-protoburp-success.png alt="Sqlmap ProtoBurp success" height=600><figcaption><p>Sqlmap payloads converted by ProtoBurp</p></figcaption></figure><h3 id=generating-a-json-payload>Generating a JSON payload<a hidden class=anchor aria-hidden=true href=#generating-a-json-payload>#</a></h3><p>You might be wondering: &ldquo;How can I generate a JSON object from a <code>.proto</code> file to use with <code>ProtoBurp</code>?&rdquo;</p><p>Easy, I wrote a script that, given a <code>.proto</code> file, will fill in placeholder values to generate a JSON payload. You can then use the JSON payload with <code>ProtoBurp</code>. Here&rsquo;s how you use the script:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ python3 json-generator.py
</span></span><span style=display:flex><span>Usage: python3 json-generator.py &lt;compiled_proto_definition_pb2.py&gt; &lt;MessageName&gt;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ python3 json-generator.py test_app/addressbook_pb2.py AddressBook
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;people&#34;</span>: <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;example&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;id&#34;</span>: 1,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;email&#34;</span>: <span style=color:#e6db74>&#34;example&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;phones&#34;</span>: <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;number&#34;</span>: <span style=color:#e6db74>&#34;example&#34;</span>,
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;PHONE_TYPE_UNSPECIFIED&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;number&#34;</span>: <span style=color:#e6db74>&#34;example&#34;</span>,
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;PHONE_TYPE_UNSPECIFIED&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;example&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;id&#34;</span>: 1,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;email&#34;</span>: <span style=color:#e6db74>&#34;example&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;phones&#34;</span>: <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;number&#34;</span>: <span style=color:#e6db74>&#34;example&#34;</span>,
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;PHONE_TYPE_UNSPECIFIED&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;number&#34;</span>: <span style=color:#e6db74>&#34;example&#34;</span>,
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;PHONE_TYPE_UNSPECIFIED&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=what-about-existing-tooling>What about existing tooling?<a hidden class=anchor aria-hidden=true href=#what-about-existing-tooling>#</a></h2><p>I&rsquo;ve used the <code>blackboxprotobuf</code> <a href=https://github.com/nccgroup/blackboxprotobuf>Burp extension</a> for years, which aids in the decoding, editing, and re-encoding of Protobuf messages without known <code>.proto</code> files. For example, the figure below shows the Protobuf from above decoded by <code>blackboxprotobuf</code>.</p><figure><img loading=lazy src=/blackbox-protobuf-result.png alt="Blackboxprotobuf in action" height=400><figcaption><p>The Blackboxprotobuf extension in action</p></figcaption></figure><p>While it is an excellent tool, one of <code>blackboxprotobuf</code>&rsquo;s notable limitations is the fact that it can only send protobuf messages it has previously seen through Burp Suite&rsquo;s proxy. Sometimes, however, researchers want to send new protobuf messages, either because we want to fuzz them, or we know the format of a specific message.</p><p><code>ProtoBurp</code> solves two novel problems:</p><ol><li>The ability to send new protobuf messages that weren&rsquo;t already seen through proxy traffic</li><li>Operability with Burp Intruder and other extensions to fuzz protobuf inputs</li></ol><h1 id=protoburp-github-repository>ProtoBurp GitHub Repository<a hidden class=anchor aria-hidden=true href=#protoburp-github-repository>#</a></h1><p>You can access <code>ProtoBurp</code>, the JSON generator script, and a test application that accepts Protobufs <a href=https://github.com/dillonfranke/protoburp>here</a>. Detailed installation and usage instructions are also included.</p><p>Please submit any bugs or feature requests to <code>ProtoBurp</code>&rsquo;s <a href=https://github.com/dillonfranke/protoburp/issues>issue tracker</a>.</p><p>Thanks for reading, and I wish you much success testing Protobufs!</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://www.dillonfrankesecurity.com/posts/cve-2023-36563-wordpad-analysis/><span class=title>« Prev</span><br><span>An Analysis of CVE-2023-36563, a WordPad Information Disclosure Vulnerability</span>
</a><a class=next href=https://www.dillonfrankesecurity.com/posts/java-static-vulnerability-analysis-to-increase-your-bounty/><span class=title>Next »</span><br><span>Java Static Vulnerability Analysis to Increase Your Bounty</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share ProtoBurp: Encode and Fuzz Custom Protobuf Messages in Burp Suite on twitter" href="https://twitter.com/intent/tweet/?text=ProtoBurp%3a%20Encode%20and%20Fuzz%20Custom%20Protobuf%20Messages%20in%20Burp%20Suite&amp;url=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fprotoburp-encode-custom-protobuf-messages-in-burp%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share ProtoBurp: Encode and Fuzz Custom Protobuf Messages in Burp Suite on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fprotoburp-encode-custom-protobuf-messages-in-burp%2f&amp;title=ProtoBurp%3a%20Encode%20and%20Fuzz%20Custom%20Protobuf%20Messages%20in%20Burp%20Suite&amp;summary=ProtoBurp%3a%20Encode%20and%20Fuzz%20Custom%20Protobuf%20Messages%20in%20Burp%20Suite&amp;source=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fprotoburp-encode-custom-protobuf-messages-in-burp%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share ProtoBurp: Encode and Fuzz Custom Protobuf Messages in Burp Suite on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fprotoburp-encode-custom-protobuf-messages-in-burp%2f&title=ProtoBurp%3a%20Encode%20and%20Fuzz%20Custom%20Protobuf%20Messages%20in%20Burp%20Suite"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share ProtoBurp: Encode and Fuzz Custom Protobuf Messages in Burp Suite on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fprotoburp-encode-custom-protobuf-messages-in-burp%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share ProtoBurp: Encode and Fuzz Custom Protobuf Messages in Burp Suite on whatsapp" href="https://api.whatsapp.com/send?text=ProtoBurp%3a%20Encode%20and%20Fuzz%20Custom%20Protobuf%20Messages%20in%20Burp%20Suite%20-%20https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fprotoburp-encode-custom-protobuf-messages-in-burp%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share ProtoBurp: Encode and Fuzz Custom Protobuf Messages in Burp Suite on telegram" href="https://telegram.me/share/url?text=ProtoBurp%3a%20Encode%20and%20Fuzz%20Custom%20Protobuf%20Messages%20in%20Burp%20Suite&amp;url=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fprotoburp-encode-custom-protobuf-messages-in-burp%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//dillon-franke-blog.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2024 <a href=https://www.dillonfrankesecurity.com>Dillon Franke Security</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>
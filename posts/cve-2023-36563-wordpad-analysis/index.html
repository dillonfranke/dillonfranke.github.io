<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><link rel=stylesheet href=https://use.typekit.net/xdt6zgj.css><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>An Analysis of CVE-2023-36563, a WordPad Information Disclosure Vulnerability | Dillon Franke Security</title>
<meta name=keywords content><meta name=description content="In this blog post, I’ll discuss my analysis of CVE-2023-36563, a Microsoft WordPad Information Disclosure Vulnerability, from initial patch diff to working exploit. Then, I’ll discuss detection and mitigation strategies for preventing exploitation of this vulnerability.
CVE-2023-36563 Overview Summary CVE-2023-36563&rsquo;s flaw lies within legacy functionality to convert an OLE 1 storage object (OLESTREAM) to the new IStorage format. By crafting a file with a malicious OLE 1 LinkedObject, an attacker could coerce authentication to an untrusted server to steal NTLM hashes."><meta name=author content><link rel=canonical href=https://www.dillonfrankesecurity.com/posts/cve-2023-36563-wordpad-analysis/><link crossorigin=anonymous href=/assets/css/stylesheet.a5f8f58a3d3d53d9337d4941ef77fb54ac2ecf51b7be756b2ee3bb485ceb7e7a.css integrity="sha256-pfj1ij09U9kzfUlB73f7VKwuz1G3vnVrLuO7SFzrfno=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://www.dillonfrankesecurity.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.dillonfrankesecurity.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.dillonfrankesecurity.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.dillonfrankesecurity.com/apple-touch-icon.png><link rel=mask-icon href=https://www.dillonfrankesecurity.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script defer data-domain=dillonfrankesecurity.com src=https://plausible.io/js/script.js></script><meta property="og:title" content="An Analysis of CVE-2023-36563, a WordPad Information Disclosure Vulnerability"><meta property="og:description" content="In this blog post, I’ll discuss my analysis of CVE-2023-36563, a Microsoft WordPad Information Disclosure Vulnerability, from initial patch diff to working exploit. Then, I’ll discuss detection and mitigation strategies for preventing exploitation of this vulnerability.
CVE-2023-36563 Overview Summary CVE-2023-36563&rsquo;s flaw lies within legacy functionality to convert an OLE 1 storage object (OLESTREAM) to the new IStorage format. By crafting a file with a malicious OLE 1 LinkedObject, an attacker could coerce authentication to an untrusted server to steal NTLM hashes."><meta property="og:type" content="article"><meta property="og:url" content="https://www.dillonfrankesecurity.com/posts/cve-2023-36563-wordpad-analysis/"><meta property="og:image" content="https://www.dillonfrankesecurity.com/cve-2023-36563-wordpad.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-23T11:21:14-07:00"><meta property="article:modified_time" content="2023-10-23T11:21:14-07:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.dillonfrankesecurity.com/cve-2023-36563-wordpad.png"><meta name=twitter:title content="An Analysis of CVE-2023-36563, a WordPad Information Disclosure Vulnerability"><meta name=twitter:description content="In this blog post, I’ll discuss my analysis of CVE-2023-36563, a Microsoft WordPad Information Disclosure Vulnerability, from initial patch diff to working exploit. Then, I’ll discuss detection and mitigation strategies for preventing exploitation of this vulnerability.
CVE-2023-36563 Overview Summary CVE-2023-36563&rsquo;s flaw lies within legacy functionality to convert an OLE 1 storage object (OLESTREAM) to the new IStorage format. By crafting a file with a malicious OLE 1 LinkedObject, an attacker could coerce authentication to an untrusted server to steal NTLM hashes."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://www.dillonfrankesecurity.com/posts/"},{"@type":"ListItem","position":3,"name":"An Analysis of CVE-2023-36563, a WordPad Information Disclosure Vulnerability","item":"https://www.dillonfrankesecurity.com/posts/cve-2023-36563-wordpad-analysis/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"An Analysis of CVE-2023-36563, a WordPad Information Disclosure Vulnerability","name":"An Analysis of CVE-2023-36563, a WordPad Information Disclosure Vulnerability","description":"In this blog post, I’ll discuss my analysis of CVE-2023-36563, a Microsoft WordPad Information Disclosure Vulnerability, from initial patch diff to working exploit. Then, I’ll discuss detection and mitigation strategies for preventing exploitation of this vulnerability.\nCVE-2023-36563 Overview Summary CVE-2023-36563\u0026rsquo;s flaw lies within legacy functionality to convert an OLE 1 storage object (OLESTREAM) to the new IStorage format. By crafting a file with a malicious OLE 1 LinkedObject, an attacker could coerce authentication to an untrusted server to steal NTLM hashes.","keywords":[],"articleBody":"In this blog post, I’ll discuss my analysis of CVE-2023-36563, a Microsoft WordPad Information Disclosure Vulnerability, from initial patch diff to working exploit. Then, I’ll discuss detection and mitigation strategies for preventing exploitation of this vulnerability.\nCVE-2023-36563 Overview Summary CVE-2023-36563’s flaw lies within legacy functionality to convert an OLE 1 storage object (OLESTREAM) to the new IStorage format. By crafting a file with a malicious OLE 1 LinkedObject, an attacker could coerce authentication to an untrusted server to steal NTLM hashes.\nInspiration There were a few things that made this vulnerability stick out to me and inspired me to figure out how it worked:\nThe vulnerability was added to CISA’s Known Exploited Vulnerabilities Catalog, meaning someone was able to exploit this vulnerability in the wild. The “information disclosure” referred to a victim’s NTLM hashes, which can be very practically abused using NTLM relay attacks. The vulnerability is triggered by opening a malicious file with WordPad, which is very applicable for phishing and red team operations. It’s WordPad, and it’s hilarious that this vulnerability was announced right as WordPad is being deprecated Technical Analysis When trying to understand how recently released (or N-day) vulnerabilities work, performing a binary patch diff is an enormous help. In essence, we compare the binary instructions of a program using software like Bindiff before and after an update is applied. This gives us vital hints regarding fixes that occurred during a patch.\nDuring my analysis, I reminded myself that this vulnerability resulted in NTLM hash disclosures. This heavily suggested that the vulnerability had something to do with making a web request or accessing a resource, since such operations can trigger an NTLM challenge-response.\nAdditionally, the CVE mentioned that the vulnerability was triggered by opening a malicious file in WordPad, so I would likely need to get familiar with the RTF file type.\nWordPad.exe Before Patch MD5: bd05d1b9fba2f5f1db6fbb59d3a78d84\nAfter Patch MD5: e46d2a1e4836b78d00eeccc0e1db0f52\nModified Functions I figured the wordpad.exe binary was a great place to start patch diffing. Bindiff identified several interesting functions that were modified by the patch. The one that interested me most was the LoadImageResource function, which sounded like it might handle retrieving an image within a document.\nWordPad.exe Modified Functions\nThis ended up being a red herring. I set a breakpoint on the function in windbg and triggered it when hovering over an icon within WordPad that loaded several preview images of bullet points. Thus, it seemed to me like the function handled loading a resource from within the WordPad executable itself–not something we’d be able to easily exploit.\nshell\\shell32\\netfldrp_ui.h(83)\\SHELL32.dll!00007FFE78FA87DF: (caller: 00007FFE7614F490) ReturnHr(5) tid(1184) 80004001 Not implemented (1498.11d4): Unknown exception - code 000006ba (first chance) (1498.11d4): Unknown exception - code 000006ba (first chance) ModLoad: 00007ffe`6c550000 00007ffe`6c567000 C:\\Windows\\system32\\OnDemandConnRouteHelper.dll ModLoad: 00007ffe`404f0000 00007ffe`4053b000 C:\\Windows\\system32\\ndfapi.dll ModLoad: 00007ffe`6f970000 00007ffe`6f98f000 C:\\Windows\\system32\\wdi.dll Breakpoint 1 hit wordpad!LoadImageResource: LoadImageResource function triggered from application resources\nNew Functions I also noticed that a new function was added called QueryConvertOLELinkCallback, a wrapper that would call a provided callback function. This wrapper was called within one of WordPad’s main editing functions, as shown below. I wasn’t sure what this was used for quite yet, but I took note of it.\nNew QueryConvertOLELinkCallback function\nAn OLE Primer The QueryConvertOLELinkCallback got me thinking that the vulnerability might have something to do with Microsoft’s Object Linking and Embedding (OLE) format. In essence, OLE allows for objects and files to be embedded within other files on Windows.\nAs a brief example of how OLE objects work, let’s examine a paint object embedded within an RTF file. To do this, we can pop open WordPad, select Insert Object and Paintbrush Picture. Then, we’ll be able to create a paint image in MsPaint and have it show up in the RTF file.\nEmbedding a paintbrush picture within an RTF document\nIf we opened the RTF file in Notepad, we would notice an \\objdata tag containing hexadecimal data for the embedded object. More on this in just a bit.\nThe embedded object’s hexadecimal data\nOLE functionality has been extensively abused by attackers, especially within Rich Text Format (RTF) files, which happens to be the default file type for WordPad. OLE was even the culprit of the infamous Follina RCE vulnerability (CVE-2022-30190).\nMuch of OLE’s functionality is implemented by the ole32.dll Windows library, so that seemed like a logical next place to explore. This is where things started to get interesting.\nOle32.dll Before Patch MD5: 5151f3912370086a405a9a7070768f4b\nAfter Patch MD5: 72907f2a113ebf319838f6276fbd0460\nModified Functions The following functions were modified from the patch. The naming convention implies they perform some sort of OLE object conversion.\nwConvertOLESTREAMToIStorage OLESTREAMToGenericObject OleConvertOLESTREAMToIStorage OleConvertOLESTREAMToIStorageEx New Functions The patch added these new functions:\nCheckOLELinkConversionRegistrySetting FindStringInMultiString IsAppExcludedFromOLELinkConversionRegistrySetting OleConvertOLESTREAMToIStorage2 OleConvertOLESTREAMToIStorageEx2 The IsAppExcludedFromOLELinkConversionRegistrySetting function instantly stuck out to me as an added check to determine whether some sort of OLE link should be processed.\nAdditionally, the addition of OleConvertOLESTREAMToIStorage2 and OleConvertOLESTREAMToIStorageEx2 was intriguing. Although it took a couple days after the patch, Microsoft added them to their official documentation. The function prototype looks like this:\nHRESULT OleConvertOLESTREAMToIStorage2( [in] LPOLESTREAM lpolestream, [out] LPSTORAGE pstg, [in] const DVTARGETDEVICE *ptd, [in] DWORD opt, [in] PVOID pvCallbackContext, [in] OLESTREAMQUERYCONVERTOLELINKCALLBACK pQueryConvertOLELinkCallback ); The last 3 arguments are new from the patch, and Microsoft’s description of them is shown below. An opt flag could now be provided to “disable a linked object during conversion.” Additionally, a pQueryConvertOLELinkCallback function pointer could be specified to determine whether a linked object should be converted or not. And remember, we noticed the QueryConvertOLELinkCallback function specified in the patched version of WordPad. Coincidence? I think not!\nNew arguments for the OleConvertOLESTREAMToIStorage2 function\nCreating an Exploit Things were now starting to make sense. Clearly, there was an unsafe conversion happening to an OLE LinkedObject that coerced NTLM authentication to occur. It was time to craft a payload to trigger this.\nCrafting the Payload Remember that embedded paint object we created earlier? Let’s take a look at the hex bytes within the \\objdata tag. I created an 010 template based on Microsoft’s documentation of the OLE 1 format, so we could see what’s going on.\nViewing the bytes of the embedded paintbrush object\nWe have the OLE magic followed by a FormatID field, which can have either the value 0x2 (as shown here) for an EmbeddedObject, or 0x1 for a LinkedObject. A LinkedObject! We know from our previous analysis that this is the type of object that triggers this vulnerability.\nMicrosoft documentation specifying the object header format\nLooking further at the documentation for a LinkedObject, I found that if the OLE object was of type LinkedObject, the TopicName field should point to a UNC path for the linked file:\nMicrosoft documentation detailing the TopicName field\nNow that sounded juicy. I went ahead and set the TopicName to be a file on a remote SMB share that I controlled. I also had to modify the payload a bit to remove the NativeDataSize and NativeData fields, since the LinkedObject structure did not contain them.\nCrafted file with a remote UNC path inside of a LinkedObject\nIt was almost time to reap the benefits of my work.\nThe Mark of the Web It is important to briefly discuss a concept on Windows known as the Mark of the Web (MOTW). Whenever a file is downloaded from a remote resource, Windows sets a specific flag on that file. The purpose is to indicate to applications that it should be treated with caution, since it is from an untrusted source. You can view this special flag by selecting a file’s Properties in Windows Explorer. Below shows the properties of my exploit file after I downloaded it from my remote server:\nMOTW flag set on downloaded exploit file\nApplications such as Word, Excel, and yes, WordPad, are designed to open files with the MOTW flag set in safe mode, prompting a user before loading any external resources. This is because, on Windows, fetching remote resources can lead to authentication challenges which can disclose NTLM credentials. If this bit is not set, security is much more lax.\nThe point is, a document that does not have the MOTW bit set and causes a remote resource to be fetched is likely not exploiting a vulnerability. Therefore, it was important to test the RTF file I crafted with the MOTW set.\nExploitation I downloaded my crafted RTF file from my web server and ensured the MOTW flag was set. Then, I spun up Responder on my remote server to listen for SMB resource requests. Next, I opened the crafted file in WordPad:\nOpening the crafted RTF file in WordPad, receiving a security warning\nNote that WordPad showed an alert which might lead one to believe that external resource fetches were blocked. However, this was not the case, as WordPad happily attempted to authenticate to my rogue server:\nSuccessful exploitation resulting in NTLM hashes\nAs shown in the procmon stack trace below, the file access resulted from the vulnerable OleConvertOLESTREAMToIStorage function.\nStack trace showing vulnerable function leading to file operations\nSuccess :)\nMitigation Microsoft released a support article a few days after Patch Tuesday which provided mitigations for CVE-2023-36563.\nUsers can add the registry key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Ole\\AppCompat\\ OLELinkConversionFromOLESTREAMToIStorage and set the DWORD value Disabled to 0x00000001, according to the document. Additionally, users can add applications they wish to allowlist for OLE link conversion to the ExclusionList key value.\nAdditionally, users should be sure to apply the patch provided by Microsoft. I confirmed that my exploit did not function after patching my system.\nDetection Exploitation of this vulnerability requires opening an RTF file with a legacy OLE 1 LinkedObject structure. You probably shouldn’t receive such a file for a legitimate reason unless you are communicating with a time traveler from the 1990’s. Additionally, a malicious LinkedObject would need to contain a remote UNC path to exploit this vulnerability.\nWith this in mind, I created the following YARA rule. I am currently retro hunting with it on Virus Total as well as looking for threat actors currently using this vulnerability.\nrule RTF_LinkedObject_UNC_Path { meta: description = \"CVE-2023-36563: Detects and RTF with a LinkedObject containing a remote UNC path in TopicName\" author = \"Dillon Franke\" reference = \"CVE-2023-36563\" strings: // Match the \\objdata tag $rtf_objdata = \"\\\\objdata\" $rtf_header = { 7B 5C 72 74 } // \"{\\rt\" // // Match OLE version and FormatID for LinkedObject $ole_header = \"0105000001000000\" // // Match UNC path prefix $unc_path_upper = { 35 43 35 43 } // \"\\\\...\" UNC path 5C5C $unc_path_lower = { 35 63 35 63 } // \"\\\\...\" UNC path 5c5c condition: // File format should be RTF $rtf_header at 0 and // // Check for \\objdata tag $rtf_objdata and // // // Check for header and UNC path after the \\objdata tag $ole_header in (@rtf_objdata..@rtf_objdata+0x50) and $unc_path_lower in (@rtf_objdata..@rtf_objdata+0x400) or $unc_path_upper in (@rtf_objdata..@rtf_objdata+0x400) } Thank You Thanks for reading. I welcome any feedback and am always willing to discuss/collaborate on vulnerability research. Please reach out me @dillon_franke on Twitter, or via my contact page.\n","wordCount":"1821","inLanguage":"en","image":"https://www.dillonfrankesecurity.com/cve-2023-36563-wordpad.png","datePublished":"2023-10-23T11:21:14-07:00","dateModified":"2023-10-23T11:21:14-07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.dillonfrankesecurity.com/posts/cve-2023-36563-wordpad-analysis/"},"publisher":{"@type":"Organization","name":"Dillon Franke Security","logo":{"@type":"ImageObject","url":"https://www.dillonfrankesecurity.com/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.dillonfrankesecurity.com accesskey=h title="Dillon Franke Security (Alt + H)">Dillon Franke Security</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.dillonfrankesecurity.com/ title=Home><span>Home</span></a></li><li><a href=https://www.dillonfrankesecurity.com/posts/ title=Blog><span>Blog</span></a></li><li><a href=https://www.dillonfrankesecurity.com/presentations/ title=Presentations><span>Presentations</span></a></li><li><a href=https://www.dillonfrankesecurity.com/services/ title=Services><span>Services</span></a></li><li><a href=https://www.dillonfrankesecurity.com/contact/ title=Contact><span>Contact</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>An Analysis of CVE-2023-36563, a WordPad Information Disclosure Vulnerability</h1><div class=post-meta>&lt;span title='2023-10-23 11:21:14 -0700 -0700'>October 23, 2023&lt;/span>&amp;nbsp;·&amp;nbsp;9 min</div></header><figure class=entry-cover><img loading=lazy src=https://www.dillonfrankesecurity.com/cve-2023-36563-wordpad.png alt></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#cve-2023-36563-overview aria-label="CVE-2023-36563 Overview">CVE-2023-36563 Overview</a><ul><li><a href=#summary aria-label=Summary>Summary</a></li><li><a href=#inspiration aria-label=Inspiration>Inspiration</a></li></ul></li><li><a href=#technical-analysis aria-label="Technical Analysis">Technical Analysis</a><ul><li><a href=#wordpadexe aria-label=WordPad.exe>WordPad.exe</a><ul><li><a href=#modified-functions aria-label="Modified Functions">Modified Functions</a></li><li><a href=#new-functions aria-label="New Functions">New Functions</a></li></ul></li><li><a href=#an-ole-primer aria-label="An OLE Primer">An OLE Primer</a></li><li><a href=#ole32dll aria-label=Ole32.dll>Ole32.dll</a><ul><li><a href=#modified-functions-1 aria-label="Modified Functions">Modified Functions</a></li><li><a href=#new-functions-1 aria-label="New Functions">New Functions</a></li></ul></li></ul></li><li><a href=#creating-an-exploit aria-label="Creating an Exploit">Creating an Exploit</a><ul><li><a href=#crafting-the-payload aria-label="Crafting the Payload">Crafting the Payload</a></li><li><a href=#the-mark-of-the-web aria-label="The Mark of the Web">The Mark of the Web</a></li><li><a href=#exploitation aria-label=Exploitation>Exploitation</a></li></ul></li><li><a href=#mitigation aria-label=Mitigation>Mitigation</a></li><li><a href=#detection aria-label=Detection>Detection</a></li><li><a href=#thank-you aria-label="Thank You">Thank You</a></li></ul></div></details></div><div class=post-content><p>In this blog post, I’ll discuss my analysis of CVE-2023-36563, a <a href=https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36563>Microsoft WordPad Information Disclosure Vulnerability</a>, from initial patch diff to working exploit. Then, I’ll discuss detection and mitigation strategies for preventing exploitation of this vulnerability.</p><h1 id=cve-2023-36563-overview>CVE-2023-36563 Overview<a hidden class=anchor aria-hidden=true href=#cve-2023-36563-overview>#</a></h1><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h2><p>CVE-2023-36563&rsquo;s flaw lies within legacy functionality to convert an OLE 1 storage object (<a href=https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-oleds/b6eebcf1-99d0-4a43-b532-f326a4ec09b4>OLESTREAM</a>) to the new <a href=https://learn.microsoft.com/en-us/windows/win32/api/objidl/nn-objidl-istorage>IStorage format</a>. By crafting a file with a malicious OLE 1 <code>LinkedObject</code>, an attacker could coerce authentication to an untrusted server to steal NTLM hashes.</p><h2 id=inspiration>Inspiration<a hidden class=anchor aria-hidden=true href=#inspiration>#</a></h2><p>There were a few things that made this vulnerability stick out to me and inspired me to figure out how it worked:</p><ol><li>The vulnerability was added to CISA’s <a href=https://www.cisa.gov/known-exploited-vulnerabilities-catalog>Known Exploited Vulnerabilities Catalog</a>, meaning someone was able to exploit this vulnerability in the wild.</li><li>The “information disclosure” referred to a victim’s NTLM hashes, which can be very practically abused using <a href=https://www.secureauth.com/blog/we-love-relaying-credentials-a-technical-guide-to-relaying-credentials-everywhere/>NTLM relay attacks</a>.</li><li>The vulnerability is triggered by opening a malicious file with WordPad, which is very applicable for phishing and red team operations.</li><li>It’s WordPad, and it’s hilarious that this vulnerability was announced right as WordPad is <a href=https://www.theverge.com/2023/9/3/23857331/microsoft-wordpad-windows-removal-end-of-support>being deprecated</a></li></ol><h1 id=technical-analysis>Technical Analysis<a hidden class=anchor aria-hidden=true href=#technical-analysis>#</a></h1><p>When trying to understand how recently released (or N-day) vulnerabilities work, performing a binary <em>patch diff</em> is an enormous help. In essence, we compare the binary instructions of a program using software like <a href=https://www.zynamics.com/bindiff.html>Bindiff</a> before and after an update is applied. This gives us vital hints regarding fixes that occurred during a patch.</p><p>During my analysis, I reminded myself that this vulnerability resulted in NTLM hash disclosures. This heavily suggested that the vulnerability had something to do with making a web request or accessing a resource, since such operations can trigger an NTLM challenge-response.</p><p>Additionally, the CVE mentioned that the vulnerability was triggered by opening a malicious file in WordPad, so I would likely need to get familiar with the RTF file type.</p><h2 id=wordpadexe>WordPad.exe<a hidden class=anchor aria-hidden=true href=#wordpadexe>#</a></h2><p>Before Patch MD5: <code>bd05d1b9fba2f5f1db6fbb59d3a78d84</code></p><p>After Patch MD5: <code>e46d2a1e4836b78d00eeccc0e1db0f52</code></p><h3 id=modified-functions>Modified Functions<a hidden class=anchor aria-hidden=true href=#modified-functions>#</a></h3><p>I figured the <code>wordpad.exe</code> binary was a great place to start patch diffing. <code>Bindiff</code> identified several interesting functions that were modified by the patch. The one that interested me most was the <code>LoadImageResource</code> function, which sounded like it might handle retrieving an image within a document.</p><figure><img loading=lazy src=/wordpad-exe-modified-functions.png alt="WordPad.exe modified functions" height=550><figcaption><p>WordPad.exe Modified Functions</p></figcaption></figure><p>This ended up being a red herring. I set a breakpoint on the function in <code>windbg</code> and triggered it when hovering over an icon within WordPad that loaded several preview images of bullet points. Thus, it seemed to me like the function handled loading a resource from within the WordPad executable itself&ndash;not something we&rsquo;d be able to easily exploit.</p><pre tabindex=0><code>shell\shell32\netfldrp_ui.h(83)\SHELL32.dll!00007FFE78FA87DF: (caller: 00007FFE7614F490) ReturnHr(5) tid(1184) 80004001 Not implemented
(1498.11d4): Unknown exception - code 000006ba (first chance)
(1498.11d4): Unknown exception - code 000006ba (first chance)
ModLoad: 00007ffe`6c550000 00007ffe`6c567000   C:\Windows\system32\OnDemandConnRouteHelper.dll
ModLoad: 00007ffe`404f0000 00007ffe`4053b000   C:\Windows\system32\ndfapi.dll
ModLoad: 00007ffe`6f970000 00007ffe`6f98f000   C:\Windows\system32\wdi.dll
Breakpoint 1 hit
wordpad!LoadImageResource:
</code></pre><figure><img loading=lazy src=/load-image-resource-triggered.png alt="Load Image Resource Triggered"><figcaption><p>LoadImageResource function triggered from application resources</p></figcaption></figure><h3 id=new-functions>New Functions<a hidden class=anchor aria-hidden=true href=#new-functions>#</a></h3><p>I also noticed that a new function was added called <code>QueryConvertOLELinkCallback</code>, a wrapper that would call a provided callback function. This wrapper was called within one of WordPad&rsquo;s main editing functions, as shown below. I wasn&rsquo;t sure what this was used for quite yet, but I took note of it.</p><figure><img loading=lazy src=/ole-callback-function-called.png alt=QueryConvertOLELinkCallback><figcaption><p>New QueryConvertOLELinkCallback function</p></figcaption></figure><h2 id=an-ole-primer>An OLE Primer<a hidden class=anchor aria-hidden=true href=#an-ole-primer>#</a></h2><p>The <code>QueryConvertOLELinkCallback</code> got me thinking that the vulnerability might have something to do with Microsoft&rsquo;s Object Linking and Embedding (OLE) format. In essence, OLE allows for objects and files to be embedded within other files on Windows.</p><p>As a brief example of how OLE objects work, let&rsquo;s examine a paint object embedded within an RTF file. To do this, we can pop open WordPad, select <code>Insert Object</code> and <code>Paintbrush Picture</code>. Then, we&rsquo;ll be able to create a paint image in MsPaint and have it show up in the RTF file.</p><figure><img loading=lazy src=/embedded-paintbrush-picture.png alt="Embedded Paint Brush Picture" height=500><figcaption><p>Embedding a paintbrush picture within an RTF document</p></figcaption></figure><p>If we opened the RTF file in Notepad, we would notice an <code>\objdata</code> tag containing hexadecimal data for the embedded object. More on this in just a bit.</p><figure><img loading=lazy src=/embedded-object-rtf-tags.png alt="Embedded Object Hexadecimal Data" height=500><figcaption><p>The embedded object&rsquo;s hexadecimal data</p></figcaption></figure><p>OLE functionality has been <a href=https://www.mcafee.com/blogs/other-blogs/mcafee-labs/an-inside-look-into-microsoft-rich-text-format-and-ole-exploits/>extensively abused by attackers</a>, especially within Rich Text Format (RTF) files, which happens to be the default file type for WordPad. OLE was even the culprit of the infamous <a href=https://owasp.org/www-community/vulnerabilities/follina>Follina RCE vulnerability</a> (CVE-2022-30190).</p><p>Much of OLE&rsquo;s functionality is implemented by the <code>ole32.dll</code> Windows library, so that seemed like a logical next place to explore. This is where things started to get interesting.</p><h2 id=ole32dll>Ole32.dll<a hidden class=anchor aria-hidden=true href=#ole32dll>#</a></h2><p>Before Patch MD5: <code>5151f3912370086a405a9a7070768f4b</code></p><p>After Patch MD5: <code>72907f2a113ebf319838f6276fbd0460</code></p><h3 id=modified-functions-1>Modified Functions<a hidden class=anchor aria-hidden=true href=#modified-functions-1>#</a></h3><p>The following functions were modified from the patch. The naming convention implies they perform some sort of OLE object conversion.</p><ul><li><code>wConvertOLESTREAMToIStorage</code></li><li><code>OLESTREAMToGenericObject</code></li><li><code>OleConvertOLESTREAMToIStorage</code></li><li><code>OleConvertOLESTREAMToIStorageEx</code></li></ul><h3 id=new-functions-1>New Functions<a hidden class=anchor aria-hidden=true href=#new-functions-1>#</a></h3><p>The patch added these new functions:</p><ul><li><code>CheckOLELinkConversionRegistrySetting</code></li><li><code>FindStringInMultiString</code></li><li><code>IsAppExcludedFromOLELinkConversionRegistrySetting</code></li><li><code>OleConvertOLESTREAMToIStorage2</code></li><li><code>OleConvertOLESTREAMToIStorageEx2</code></li></ul><p>The <code>IsAppExcludedFromOLELinkConversionRegistrySetting</code> function instantly stuck out to me as an added check to determine whether some sort of OLE link should be processed.</p><p>Additionally, the addition of <code>OleConvertOLESTREAMToIStorage2</code> and <code>OleConvertOLESTREAMToIStorageEx2</code> was intriguing. Although it took a couple days after the patch, Microsoft added them to their <a href=https://learn.microsoft.com/en-us/windows/win32/stg/oleconvertolestreamtoistorage2>official documentation</a>. The function prototype looks like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c++ data-lang=c++><span style=display:flex><span>HRESULT <span style=color:#a6e22e>OleConvertOLESTREAMToIStorage2</span>(
</span></span><span style=display:flex><span>  [in]  LPOLESTREAM          lpolestream,
</span></span><span style=display:flex><span>  [out] LPSTORAGE            pstg,
</span></span><span style=display:flex><span>  [in]  <span style=color:#66d9ef>const</span> DVTARGETDEVICE <span style=color:#f92672>*</span>ptd,
</span></span><span style=display:flex><span>  [in]  DWORD                opt,
</span></span><span style=display:flex><span>  [in]  PVOID                pvCallbackContext,
</span></span><span style=display:flex><span>  [in]  OLESTREAMQUERYCONVERTOLELINKCALLBACK pQueryConvertOLELinkCallback
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>The last 3 arguments are new from the patch, and Microsoft&rsquo;s description of them is shown below. An <code>opt</code> flag could now be provided to &ldquo;disable a linked object during conversion.&rdquo; Additionally, a <code>pQueryConvertOLELinkCallback</code> function pointer could be specified to determine whether a linked object should be converted or not. And remember, we noticed the <code>QueryConvertOLELinkCallback</code> function specified in the patched version of WordPad. Coincidence? I think not!</p><figure><img loading=lazy src=/OleConvertOLESTREAMToIStorage2-new-parameters.png alt="OleConvertOLESTREAMToIStorage2 New Arguments"><figcaption><p>New arguments for the OleConvertOLESTREAMToIStorage2 function</p></figcaption></figure><h1 id=creating-an-exploit>Creating an Exploit<a hidden class=anchor aria-hidden=true href=#creating-an-exploit>#</a></h1><p>Things were now starting to make sense. Clearly, there was an unsafe conversion happening to an OLE <code>LinkedObject</code> that coerced NTLM authentication to occur. It was time to craft a payload to trigger this.</p><h2 id=crafting-the-payload>Crafting the Payload<a hidden class=anchor aria-hidden=true href=#crafting-the-payload>#</a></h2><p>Remember that embedded paint object we created earlier? Let&rsquo;s take a look at the hex bytes within the <code>\objdata</code> tag. I created an 010 template based on Microsoft&rsquo;s documentation of the OLE 1 format, so we could see what&rsquo;s going on.</p><figure><img loading=lazy src=/viewing-embedded-object-bytes.png alt="Viewing Embedded Object Bytes"><figcaption><p>Viewing the bytes of the embedded paintbrush object</p></figcaption></figure><p>We have the OLE magic followed by a <code>FormatID</code> field, which can have either the value <code>0x2</code> (as shown here) for an <code>EmbeddedObject</code>, or <code>0x1</code> for a <code>LinkedObject</code>. A <code>LinkedObject</code>! We know from our previous analysis that this is the type of object that triggers this vulnerability.</p><figure><img loading=lazy src=/microsoft-object-header-details.png alt="Microsoft Object Header Details"><figcaption><p>Microsoft documentation specifying the object header format</p></figcaption></figure><p>Looking further at the documentation for a <code>LinkedObject</code>, I found that if the OLE object was of type <code>LinkedObject</code>, the <code>TopicName</code> field should point to a UNC path for the linked file:</p><figure><img loading=lazy src=/linkedobj-topic-name-doc.png alt="LinkedObject TopicName Documentation"><figcaption><p>Microsoft documentation detailing the TopicName field</p></figcaption></figure><p>Now that sounded juicy. I went ahead and set the <code>TopicName</code> to be a file on a remote SMB share that I controlled. I also had to modify the payload a bit to remove the <code>NativeDataSize</code> and <code>NativeData</code> fields, since the <code>LinkedObject</code> structure did not contain them.</p><figure><img loading=lazy src=/crafted-malicious-file.png alt="Crafted Malicious File"><figcaption><p>Crafted file with a remote UNC path inside of a LinkedObject</p></figcaption></figure><p>It was almost time to reap the benefits of my work.</p><h2 id=the-mark-of-the-web>The Mark of the Web<a hidden class=anchor aria-hidden=true href=#the-mark-of-the-web>#</a></h2><p>It is important to briefly discuss a concept on Windows known as the Mark of the Web (MOTW). Whenever a file is downloaded from a remote resource, Windows sets a specific flag on that file. The purpose is to indicate to applications that it should be treated with caution, since it is from an untrusted source. You can view this special flag by selecting a file&rsquo;s <strong>Properties</strong> in Windows Explorer. Below shows the properties of my exploit file after I downloaded it from my remote server:</p><figure><img loading=lazy src=/motw-bit-set.png alt="The Mark of the Web" height=500><figcaption><p>MOTW flag set on downloaded exploit file</p></figcaption></figure><p>Applications such as Word, Excel, and yes, WordPad, are designed to open files with the MOTW flag set in safe mode, prompting a user before loading any external resources. This is because, on Windows, fetching remote resources can lead to authentication challenges which can disclose NTLM credentials. If this bit is <em>not</em> set, security is much more lax.</p><p>The point is, a document that does <em>not</em> have the MOTW bit set and causes a remote resource to be fetched is likely <em>not</em> exploiting a vulnerability. Therefore, it was important to test the RTF file I crafted with the MOTW set.</p><h2 id=exploitation>Exploitation<a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><p>I downloaded my crafted RTF file from my web server and ensured the MOTW flag was set. Then, I spun up <a href=https://github.com/lgandx/Responder>Responder</a> on my remote server to listen for SMB resource requests. Next, I opened the crafted file in WordPad:</p><figure><img loading=lazy src=/security-warning-but-still-works.png alt="Opening Exploit in WordPad With Security Warning"><figcaption><p>Opening the crafted RTF file in WordPad, receiving a security warning</p></figcaption></figure><p>Note that WordPad showed an alert which might lead one to believe that external resource fetches were blocked. However, this was not the case, as WordPad happily attempted to authenticate to my rogue server:</p><figure><img loading=lazy src=/exploit-success-ntlm-hashes.png alt="Exploit Success NTLM Hashes"><figcaption><p>Successful exploitation resulting in NTLM hashes</p></figcaption></figure><p>As shown in the <code>procmon</code> stack trace below, the file access resulted from the vulnerable <code>OleConvertOLESTREAMToIStorage</code> function.</p><figure><img loading=lazy src=/stack-trace-procmon.png alt="Procmon Stack Trace"><figcaption><p>Stack trace showing vulnerable function leading to file operations</p></figcaption></figure><p>Success :)</p><h1 id=mitigation>Mitigation<a hidden class=anchor aria-hidden=true href=#mitigation>#</a></h1><p>Microsoft released a <a href=https://support.microsoft.com/en-us/topic/kb5032314-how-to-manage-the-ole-object-conversion-vulnerability-associated-with-cve-2023-36563-98d95ae9-2f9e-4f65-9231-46363c31cf07>support article</a> a few days after Patch Tuesday which provided mitigations for CVE-2023-36563.</p><p>Users can add the registry key <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Ole\AppCompat\ OLELinkConversionFromOLESTREAMToIStorage</code> and set the DWORD value <code>Disabled</code> to <code>0x00000001</code>, according to the document. Additionally, users can add applications they wish to allowlist for OLE link conversion to the <code>ExclusionList</code> key value.</p><p>Additionally, users should be sure to <a href=https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36563>apply the patch</a> provided by Microsoft. I confirmed that my exploit did not function after patching my system.</p><h1 id=detection>Detection<a hidden class=anchor aria-hidden=true href=#detection>#</a></h1><p>Exploitation of this vulnerability requires opening an RTF file with a legacy OLE 1 <code>LinkedObject</code> structure. You probably shouldn&rsquo;t receive such a file for a legitimate reason unless you are communicating with a time traveler from the 1990&rsquo;s. Additionally, a malicious <code>LinkedObject</code> would need to contain a remote UNC path to exploit this vulnerability.</p><p>With this in mind, I created the following YARA rule. I am currently retro hunting with it on Virus Total as well as looking for threat actors currently using this vulnerability.</p><pre tabindex=0><code>rule RTF_LinkedObject_UNC_Path {
    meta:
        description = &#34;CVE-2023-36563: Detects and RTF with a LinkedObject containing a remote UNC path in TopicName&#34;
        author = &#34;Dillon Franke&#34;
        reference = &#34;CVE-2023-36563&#34;

    strings:
        // Match the \objdata tag
        $rtf_objdata = &#34;\\objdata&#34;

        $rtf_header = { 7B 5C 72 74 } // &#34;{\rt&#34;

        // // Match OLE version and FormatID for LinkedObject
        $ole_header = &#34;0105000001000000&#34;

        // // Match UNC path prefix
        $unc_path_upper = { 35 43 35 43 } // &#34;\\...&#34; UNC path 5C5C
        $unc_path_lower = { 35 63 35 63 } // &#34;\\...&#34; UNC path 5c5c

    condition:
        // File format should be RTF
        $rtf_header at 0 and

        // // Check for \objdata tag
        $rtf_objdata and

        // // // Check for header and UNC path after the \objdata tag
        $ole_header in (@rtf_objdata..@rtf_objdata+0x50) and 
        $unc_path_lower in (@rtf_objdata..@rtf_objdata+0x400) or
        $unc_path_upper in (@rtf_objdata..@rtf_objdata+0x400)
}
</code></pre><h1 id=thank-you>Thank You<a hidden class=anchor aria-hidden=true href=#thank-you>#</a></h1><p>Thanks for reading. I welcome any feedback and am always willing to discuss/collaborate on vulnerability research. Please reach out me @dillon_franke on Twitter, or via my <a href=/contact>contact</a> page.</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://www.dillonfrankesecurity.com/posts/protoburp-encode-custom-protobuf-messages-in-burp/><span class=title>Next »</span><br><span>ProtoBurp: Encode and Fuzz Custom Protobuf Messages in Burp Suite</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share An Analysis of CVE-2023-36563, a WordPad Information Disclosure Vulnerability on twitter" href="https://twitter.com/intent/tweet/?text=An%20Analysis%20of%20CVE-2023-36563%2c%20a%20WordPad%20Information%20Disclosure%20Vulnerability&amp;url=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fcve-2023-36563-wordpad-analysis%2f&amp;hashtags="><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share An Analysis of CVE-2023-36563, a WordPad Information Disclosure Vulnerability on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fcve-2023-36563-wordpad-analysis%2f&amp;title=An%20Analysis%20of%20CVE-2023-36563%2c%20a%20WordPad%20Information%20Disclosure%20Vulnerability&amp;summary=An%20Analysis%20of%20CVE-2023-36563%2c%20a%20WordPad%20Information%20Disclosure%20Vulnerability&amp;source=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fcve-2023-36563-wordpad-analysis%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share An Analysis of CVE-2023-36563, a WordPad Information Disclosure Vulnerability on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fcve-2023-36563-wordpad-analysis%2f&title=An%20Analysis%20of%20CVE-2023-36563%2c%20a%20WordPad%20Information%20Disclosure%20Vulnerability"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share An Analysis of CVE-2023-36563, a WordPad Information Disclosure Vulnerability on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fcve-2023-36563-wordpad-analysis%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share An Analysis of CVE-2023-36563, a WordPad Information Disclosure Vulnerability on whatsapp" href="https://api.whatsapp.com/send?text=An%20Analysis%20of%20CVE-2023-36563%2c%20a%20WordPad%20Information%20Disclosure%20Vulnerability%20-%20https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fcve-2023-36563-wordpad-analysis%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share An Analysis of CVE-2023-36563, a WordPad Information Disclosure Vulnerability on telegram" href="https://telegram.me/share/url?text=An%20Analysis%20of%20CVE-2023-36563%2c%20a%20WordPad%20Information%20Disclosure%20Vulnerability&amp;url=https%3a%2f%2fwww.dillonfrankesecurity.com%2fposts%2fcve-2023-36563-wordpad-analysis%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//dillon-franke-blog.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2023 <a href=https://www.dillonfrankesecurity.com>Dillon Franke Security</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>